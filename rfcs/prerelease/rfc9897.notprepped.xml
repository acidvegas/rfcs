<?xml version='1.0' encoding='UTF-8'?>

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" version="3" ipr="trust200902" docName="draft-ietf-tsvwg-multipath-dccp-24" number="9897" updates="" obsoletes="" category="std" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true" tocDepth="3" xml:lang="en">

  <front>
    <title abbrev="Multipath DCCP">Datagram Congestion Control Protocol (DCCP) Extensions for Multipath Operation with Multiple Addresses</title>
    <seriesInfo name="RFC" value="9897"/>
    <author initials="M." surname="Amend" fullname="Markus Amend" role="editor">
      <organization abbrev="DT">Deutsche Telekom</organization>
      <address>
        <postal>
          <street>Deutsche-Telekom-Allee 9</street>
          <city>Darmstadt</city>
          <code>64295</code>
          <country>Germany</country>
        </postal>
        <email>Markus.Amend@telekom.de</email>
      </address>
    </author>
    <author initials="A." surname="Brunstrom" fullname="Anna Brunstrom">
      <organization>Karlstad University</organization>
      <address>
        <postal>
          <street>Universitetsgatan 2</street>
          <city>Karlstad</city>
          <code>651 88</code>
          <country>Sweden</country>
        </postal>
        <email>anna.brunstrom@kau.se</email>
      </address>
    </author>
    <author initials="A." surname="Kassler" fullname="Andreas Kassler">
      <organization>Karlstad University</organization>
      <address>
        <postal>
          <street>Universitetsgatan 2</street>
          <city>Karlstad</city>
          <code>651 88</code>
          <country>Sweden</country>
        </postal>
        <email>andreas.kassler@kau.se</email>
      </address>
    </author>
    <author initials="V." surname="Rakocevic" fullname="Veselin Rakocevic">
      <organization>City St George's, University of London</organization>
      <address>
        <postal>
          <street>Northampton Square</street>
          <city>London</city>
          <country>United Kingdom</country>
        </postal>
        <email>veselin.rakocevic.1@city.ac.uk</email>
      </address>
    </author>
    <author initials="S." surname="Johnson" fullname="Stephen Johnson">
      <organization>BT</organization>
      <address>
        <postal>
          <street>Adastral Park</street>
          <city>Martlesham Heath</city>
          <code>IP5 3RE</code>
          <country>United Kingdom</country>
        </postal>
        <email>stephen.h.johnson@bt.com</email>
      </address>
    </author>
    <date month="January" year="2026"/>

    <area>WIT</area>
    <workgroup>tsvwg</workgroup>

    <keyword>dccp</keyword>
    <keyword>extensions</keyword>
    <keyword>multipath</keyword>
    <keyword>multihomed</keyword>
    <keyword>subflow</keyword>
    <keyword>concurrent</keyword>
    <keyword>simultaneous</keyword>
    <keyword>mobility</keyword>
    <keyword>mpdccp</keyword>
    <keyword>mp-dccp</keyword>

    <abstract>
      <t>Datagram Congestion Control Protocol (DCCP) communications, as defined in RFC 4340, are inherently restricted to a single path per connection, despite the availability of multiple network paths between peers. The ability to utilize multiple paths simultaneously for a DCCP session can enhance network resource utilization, improve throughput, and increase resilience to network failures, ultimately enhancing the user experience.</t>
      <t>Use cases for Multipath DCCP (MP-DCCP) include mobile devices (e.g., handsets and vehicles) and residential home gateways that maintain simultaneous connections to distinct network types such as cellular and Wireless Local Area Networks (WLANs) or cellular and fixed access networks. Compared to existing multipath transport protocols, such as Multipath TCP (MPTCP), MP-DCCP is particularly suited for latency-sensitive applications with varying requirements for reliability and in-order delivery.</t>
      <t>This document specifies a set of protocol extensions to DCCP that enable multipath operations. These extensions maintain the same service model as DCCP while introducing mechanisms to establish and utilize multiple concurrent DCCP flows across different network paths.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="intro">
      <name>Introduction</name>
      <t>The Datagram Congestion Control Protocol (DCCP) <xref target="RFC4340"/>
      is a transport protocol that provides bidirectional unicast connections
      of congestion-controlled unreliable datagrams. DCCP communications are
      restricted to one single path. Other fundamentals of the DCCP protocol
      are summarized in <xref target="RFC4340" sectionFormat="of"
      section="1"/> such as the reliable handshake process in <xref
      target="RFC4340" sectionFormat="of" section="4.7"/> and the reliable
      negotiation of features in <xref target="RFC4340"
      sectionFormat="of" section="4.5"/>. These are an important basis for
      this document. These fundamentals also apply to the DCCP sequencing scheme, which is
      packet-based (<xref target="RFC4340" sectionFormat="of"
      section="4.2"/>), and the principles for loss and retransmission of
      features as described in more detail in <xref target="RFC4340"
      sectionFormat="of" section="6.6.3"/>.  This document specifies a set
      of protocol changes that add multipath support to DCCP, specifically
      support for signaling and setting up multiple paths (a.k.a., "subflows"),
      managing these subflows, the reordering of data, and the termination of
      sessions.</t>
      <t>Multipath DCCP (MP-DCCP) 
enables a DCCP connection to simultaneously establish a flow across multiple paths. This can be  beneficial to applications that transfer
large amounts of data, by utilizing the capacity/connectivity offered by 
multiple paths. In addition, the multipath extensions enable the trade-off of timeliness and reliability, which is important for low-latency applications that do not require
      guaranteed delivery services such as Audio/Video streaming.</t>
      
      <t>In addition to the integration into DCCP services, implementers or future specifications could choose MP-DCCP for other use cases such as
3GPP 5G multi-access solutions (e.g., Access Traffic Steering, Switching, and Splitting (ATSSS) specified in <xref target="TS23.501"/>) or hybrid access networks. ATSSS combines 3GPP and non-3GPP access between the user equipment and an operator network, while hybrid access combines fixed and cellular access between a residential gateway and an operator network. MP-DCCP can be used in these scenarios for load balancing, seamless session handover, and bandwidth aggregation when non-DCCP traffic such as IP, UDP, or TCP is encapsulated into MP-DCCP. More details on potential use cases for MP-DCCP are provided in <xref target="MP-DCCP.Site"/>, <xref target="IETF105.Slides"/>, and <xref target="MP-DCCP.Paper"/>.
All of these use cases profit from an Open Source Linux reference implementation provided under <xref target="MP-DCCP.Site"/>.</t>
      <t>The encapsulation of non-DCCP traffic (e.g., UDP or IP) in MP-DCCP to enable the above-mentioned use cases is not considered in this specification.
Also out of scope is the encapsulation of DCCP traffic in UDP to pass middleboxes (e.g., NATs, firewalls, proxies, intrusion detection systems (IDSs), etc.) that do not support DCCP. However, a possible method is defined in <xref target="RFC6773"/> and considered in <xref target="I-D.amend-tsvwg-dccp-udp-header-conversion"/> to achieve the same with less overhead.</t>
      <t>MP-DCCP is based exclusively on the lean concept of DCCP. For traffic that is already encrypted or does not need encryption, MP-DCCP is an efficient choice as it does not apply its own encryption mechanisms. Also, the procedures defined by MP-DCCP, which allow subsequent reordering of traffic and efficient traffic scheduling, improve performance, as shown in <xref target="MP-DCCP.Paper"/>, and take into account the interaction of the protocol with the further elements required for multipath transport.</t>
      <section anchor="mpdccp_network_stack">
        <name>Multipath DCCP in the Networking Stack</name>
        <t>MP-DCCP provides a set of features to DCCP; <xref target="ref-comparison-of-standard-dccp-and-mp-dccp-protocol-stacks"/> illustrates this layering. 
MP-DCCP is
designed to be used by applications in the same way as DCCP with no
changes to the application itself.</t>
        <figure anchor="ref-comparison-of-standard-dccp-and-mp-dccp-protocol-stacks">
          <name>Comparison of Standard DCCP and MP-DCCP Protocol Stacks</name>
          <artwork><![CDATA[
                             +-------------------------------+
                             |           Application         |
+---------------+            +-------------------------------+
|  Application  |            |            MP-DCCP            |
+---------------+            + - - - - - - - + - - - - - - - +
|      DCCP     |            |Subflow (DCCP) |Subflow (DCCP) |
+---------------+            +-------------------------------+
|      IP       |            |       IP      |      IP       |
+---------------+            +-------------------------------+]]></artwork>
        </figure>
        <t>A command-line interface (CLI) at the endpoint (or another method) could be used to configure and manage the DCCP connections. This could be extended to also support MP-DCCP, but this specification does not define it.</t>
      </section>
      <section anchor="terminology">
        <name>Terminology</name>
        <t>This document uses terms that are either specific for multipath
        transport as defined in <xref target="RFC8684"/> or defined in the
        context of MP-DCCP, as follows:</t>

	<dl spacing="normal" newline="false">
          <dt>Path:</dt><dd><t>A sequence of links between a sender and a
          receiver, defined in this context by a 4-tuple of the source and
          destination address and the source and destination ports. This
          definition follows <xref target="RFC8684"/> and is illustrated in
          the following two examples for IPv6 and IPv4, which each show a pair
          of sender IP-address:port and a pair of receiver IP-address:port,
          which together form the 4-tuple:</t>
          <ul>
            <li>IPv6: [2001:db8:3333:4444:5555:6666:7777:8888]:1234, [2001:db8:3333:4444:cccc:dddd:eeee:ffff]:4321</li>
            <li>IPv4: 203.0.113.1:1234, 203.0.113.2:4321</li>
          </ul></dd>
          <dt>Subflow:</dt><dd>A DCCP flow that is transmitted
          by using a specific path (4-tuple of source and destination
          address/port pairs) that forms one of the multipath flows used by a
          single connection.</dd>
          <dt>(MP-DCCP) Connection:</dt><dd>A set of one or more subflows,
          over which an application can communicate between two hosts. The
          MP-DCCP connection is exposed as a single DCCP socket to the
          application.</dd>
          <dt>Connection Identifier (CI):</dt><dd>A unique identifier that is
          assigned to a multipath connection by the host to distinguish
          several multipath connections locally. The CIs must therefore be
          locally unique per host and do not have to be the same across the
          peers.</dd>
          <dt>Host:</dt><dd>An end host that operates an MP-DCCP implementation
          and either initiates or accepts an MP-DCCP connection.</dd>
          <dt>'+':</dt><dd>The plus symbol means the concatenation of values.</dd>
	</dl>
        <t>In addition to these terms, within the framework of MP-DCCP, the
        interpretation of, and effect on, regular single-path DCCP semantics
        is discussed in <xref target="protocol"/>.</t>
      </section>
      <section anchor="requirements-language">
        <name>Requirements Language</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>
    <section anchor="op_overview">
      <name>Operation Overview</name>
      <t>DCCP transmits congestion-controlled unreliable datagrams over a single path.
Various congestion control mechanisms have been specified to optimize
DCCP performance for specific traffic types in terms of profiles denoted
by a Congestion Control IDentifier (CCID).
However, DCCP does not provide built-in
support for managing multiple subflows within one DCCP connection. The
extension of DCCP for Multipath DCCP (MP-DCCP) is described in detail
in <xref target="protocol"/>.</t>
      <t>At a high level of MP-DCCP operation, the data
stream from a DCCP application is split
by the MP-DCCP operation into one or more subflows that can be
transmitted via different paths, for example, using paths via different links.
The corresponding control information allows the receiver to optionally
reassemble and deliver the received data in the originally transmitted order to the
recipient application. This may be necessary because DCCP does not guarantee in-order delivery.
The details of the transmission scheduling mechanism and
optional reordering mechanism are up to the sender and receiver, respectively,
and are outside the scope of this document.</t>
      <t>An MP-DCCP connection provides a bidirectional connection of datagrams
between two hosts exchanging data using DCCP. It does not require
any change to the applications. MP-DCCP enables the
hosts to use multiple paths with different 4-tuples to transport
the packets of an MP-DCCP connection. MP-DCCP manages the request,
set-up, authentication, prioritization, modification, and removal of
the DCCP subflows on different paths as well as the exchange of performance
      parameters.</t>
<t>The number of DCCP subflows can vary during the 
lifetime of an MP-DCCP connection. The details of the path management decisions for
when to add or remove subflows are outside the scope of this document.</t>
      <t>The multipath capability for MP-DCCP is negotiated with a new DCCP 
feature, as specified in <xref target="mp_capable"/>. Once 
negotiated, all subsequent MP-DCCP operations for that connection are signaled with a 
variable length multipath-related option, as described in <xref target="protocol"/>.
All MP-DCCP operations are signaled by Multipath Options described in <xref target="MP_OPT"/>. Options that 
require confirmation from the remote peer are retransmitted by the sender until confirmed or until 
confirmation is no longer considered relevant.</t>
      <t>The sections that follow define MP-DCCP behavior in detail.</t>
      <section anchor="concept">
        <name>MP-DCCP Concept</name>
        <t><xref target="ref-example-mp-dccp-usage-scenario"/> provides a general overview of the MP-DCCP working mode, whose main 
characteristics are summarized in this section.</t>
        <figure anchor="ref-example-mp-dccp-usage-scenario">
          <name>Example MP-DCCP Usage Scenario</name>
          <artwork><![CDATA[
           Host A                               Host B
------------------------             ------------------------
Address A1    Address A2             Address B1    Address B2
----------    ----------             ----------    ----------
  |             |                      |             |
  |         (DCCP subflow setup)       |             |
  |----------------------------------->|             |
  |<-----------------------------------|             |
  |             |                      |             |
  |             |  (DCCP subflow setup)|             |
  |             |--------------------->|             |
  |             |<---------------------|             |
  | merge individual DCCP subflows to one MP-DCCP connection
  |             |                      |             |]]></artwork>
        </figure>
        <ul>
          <li>
            <t>An MP-DCCP connection begins with a 4-way handshake between 
two hosts. In <xref target="ref-example-mp-dccp-usage-scenario"/>,
an MP-DCCP connection is established between addresses A1 and B1 on Hosts
A and B. In the handshake, a Multipath Capable Feature is used to negotiate multipath support for the connection. Host-specific keys are also exchanged between Host A and Host B during the handshake. The details of the MP-DCCP handshake procedure is described in <xref target="handshaking"/>. MP-DCCP does not require both peers to have 
more than one address.</t>
          </li>
          <li>
            <t>When additional paths and corresponding addresses/ports are available, additional DCCP subflows can be created on 
these paths and attached to the existing MP-DCCP connection. An MP_JOIN option is used to connect a new DCCP subflow to an existing MP-DCCP connection. It contains a Connection Identifier (CI) during the setup of the initial subflow and is exchanged in the 4-way handshake for the subflow together with the Multipath Capable Feature. The example in <xref target="ref-example-mp-dccp-usage-scenario"/> illustrates the creation of an additional DCCP subflow between Address A2 on Host A and Address B1 on Host B. The two subflows
continue to provide a single connection to the applications at both
endpoints.</t>
          </li>
          <li>
            <t>MP-DCCP identifies multiple paths by the presence of multiple
addresses/ports at hosts.  Combinations of these multiple addresses/ports
indicate the additional paths.  In the example, other potential
paths that could be set up are A1&lt;-&gt;B2 and A2&lt;-&gt;B2.  Although the
additional subflow in the example is shown as being initiated from A2, an additional subflow could
alternatively have been initiated from B1 or B2.</t>
          </li>
          <li>
            <t>The discovery and setup of additional subflows is achieved
through a path management method including the logic and details of the procedures for adding/removing subflows.
This document describes the procedures that enable a host to initiate new subflows or to signal available IP addresses between peers. However, the definition of a path management method, in which sequence and when subflows are created, is outside the scope of this document. This method is subject to a 
corresponding policy and the specifics of the implementation. If an MP-DCCP peer host wishes to limit the maximum number of paths that can be maintained (e.g., similar to that discussed in <xref target="RFC8041" sectionFormat="of" section="3.4"/>), the creation of new subflows from that peer host is omitted when the threshold of maximum paths is exceeded and incoming subflow requests <bcp14>MUST</bcp14> be rejected.</t>
          </li>
          <li>
            <t>Through the use of Multipath Options, MP-DCCP adds connection-level sequence numbers and the exchange of
Round-Trip Time (RTT) information to enable optional reordering features. As a hint for scheduling decisions, a Multipath Option that allows a peer to indicate its priorities for which path to use is also defined.</t>
          </li>
          <li>
            <t>Subflows are terminated in the same way as regular DCCP connections, as described
in <xref target="RFC4340" sectionFormat="of" section="8.3"/>. MP-DCCP connections are closed by including an MP_CLOSE option in subflow DCCP-CloseReq or DCCP-Close messages. An MP-DCCP connection may also be reset through the use of an MP_FAST_CLOSE option. Key Data from the initial handshake is included in MP_CLOSE and MP_FAST_CLOSE to protect from an unauthorized shutdown of MP-DCCP connections.</t>
          </li>
        </ul>
      </section>
    </section>
    <section anchor="protocol">
      <name>MP-DCCP Protocol</name>
      <t>The DCCP protocol feature list (<xref section="6.4" target="RFC4340"/>) is
extended in this document by adding a new Multipath Feature with Feature Number 10, as
shown in <xref target="ref-feature-list"/>.</t>
      <table anchor="ref-feature-list">
        <name>Multipath Feature</name>
        <thead>
          <tr>
            <th>Number</th>
            <th>Meaning</th>
            <th>Rec'n Rule</th>
            <th>Initial Value</th>
            <th>Req'd</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>10</td>
            <td>Multipath Capable</td>
            <td>SP</td>
            <td>0</td>
            <td>N</td>
          </tr>
        </tbody>
      </table>
      <dl>
        <dt>Rec'n Rule:</dt>
        <dd>
          <t>The reconciliation rule used for the feature. SP indicates the server-priority as defined in <xref target="RFC4340" sectionFormat="of" section="6.3"/>.</t>
        </dd>
        <dt>Initial Value:</dt>
        <dd>
          <t>The initial value for the feature. Every feature has a known initial value.</t>
        </dd>
        <dt>Req'd:</dt>
        <dd>
          <t>This column is "Y" if and only if every DCCP implementation <bcp14>MUST</bcp14>
understand the feature. If it is "N", then the feature behaves like an extension, and it is safe to respond to Change options for the feature
with empty Confirm options.</t>
        </dd>
      </dl>
      <t>This specification adds a DCCP protocol option as defined in <xref target="RFC4340" sectionFormat="of" section="5.8"/>, providing
a new multipath-related variable-length option with option type 46, as
shown in <xref target="ref-option-list"/>.</t>
      <table anchor="ref-option-list">
        <name>Multipath Option Set</name>
        <thead>
          <tr>
            <th>Type</th>
            <th>Option Length</th>
            <th>Meaning</th>
            <th>DCCP-Data?</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>46</td>
            <td>variable</td>
            <td>Multipath</td>
            <td>Y</td>
          </tr>
        </tbody>
      </table>
      <section anchor="mp_capable">
        <name>Multipath Capable Feature</name>
        <t>A DCCP endpoint negotiates the Multipath Capable Feature to determine whether multipath extensions can be enabled for a DCCP connection.</t>
        <t>The Multipath Capable Feature (MP_CAPABLE) has Feature Number 10 and follows the structure for features given in <xref target="RFC4340" sectionFormat="of" section="6"/>. Beside the negotiation of the feature itself, one or several values can also be exchanged. The value field specified here for the Multipath Capable Feature has a Length of one byte and can be repeated several times within the DCCP option for feature negotiation. This can be, for example, required to announce support of different versions of the protocol. For that, the leftmost four bits in <xref target="ref-mp-capable-format"/> specify the compatible version of the
MP-DCCP implementation and <bcp14>MUST</bcp14> be set to 0 following this specification. The four bits following the Version field are unassigned in version 0 and <bcp14>MUST</bcp14> be set to zero by the sender and <bcp14>MUST</bcp14> be ignored by the receiver.</t>
        <figure anchor="ref-mp-capable-format">
          <name>Format of the Multipath Capable Feature Value Field</name>
          <artwork><![CDATA[
 0  1  2  3   4  5  6  7
+-----------+------------+
|  Version  | Unassigned |
+-----------+------------+]]></artwork>
        </figure>
        <t>The setting of the Multipath Capable Feature <bcp14>MUST</bcp14> follow the server-priority reconciliation rule described
in <xref target="RFC4340" sectionFormat="of" section="6.3.1"/>. This allows multiple versions to be
specified in order of priority.</t>
        <t>The negotiation <bcp14>MUST</bcp14> be a part of the initial handshake procedure
 described in <xref target="handshaking"/>. No subsequent renegotiation of
the Multipath Capable Feature is allowed for the same MP-DCCP connection.</t>
        <t>Clients <bcp14>MUST</bcp14> include a Change R option (<xref section="6" sectionFormat="of" target="RFC4340"/>) during the initial handshake request to
supply a list of supported MP-DCCP protocol versions, ordered by preference.</t>
        <t>Servers <bcp14>MUST</bcp14> include a Confirm L option (<xref section="6" sectionFormat="of" target="RFC4340"/>) in the subsequent response to agree on
an MP-DCCP version to be used from the Client list, followed by its own
supported version(s), ordered by preference. Any subflow added to an existing MP-DCCP connection <bcp14>MUST</bcp14> use the
version negotiated for the first subflow.</t>
        <t>If no agreement is found, the Server <bcp14>MUST</bcp14> reply with an empty Confirm L option
with Feature Number 10 and no values.</t>
        <t>An example of successful version negotiation is shown hereafter and follows the negotiation example shown in <xref target="RFC4340" sectionFormat="of" section="6.5"/>. For better understanding, this example uses the unspecified MP-DCCP versions 1 and 2 in addition to the MP-DCCP version 0 specified in this document:</t>
        <figure anchor="ref-mp-capable-example">
          <name>Example of MP-DCCP Support Negotiation Using MP_CAPABLE</name>
          <artwork><![CDATA[
Client                                             Server
------                                             ------
DCCP-Req + Change R(MP_CAPABLE, 1 0)
               ----------------------------------->

                DCCP-Resp + Confirm L(MP_CAPABLE, 1, 2 1 0)
      <-----------------------------------

           * agreement on version = 1 *]]></artwork>
        </figure>
	
<t>This example illustrates the following:
</t>
        <ol><li>
            <t>The Client indicates support for both MP-DCCP versions 1 and 0, with a preference for version 1.</t>
          </li>
          <li>
            <t>The Server agrees on using MP-DCCP version 1 indicated by the first value and supplies its own preference list with the subsequent values.</t>
          </li>
          <li>
            <t>MP-DCCP is then enabled between the Client and Server with version 1.</t>
          </li>
        </ol>
        <t>Unlike the example in <xref target="ref-mp-capable-example"/>, this document only allows the
negotiation of MP-DCCP version 0.  Therefore, per successful
negotiation of MP-DCCP as defined in this document, the Client
and the Server <bcp14>MUST</bcp14> both support MP-DCCP version 0.</t>
        <t>If the version negotiation fails or the Multipath Capable Feature is not present in the DCCP-Request or DCCP-Response packets of the initial handshake procedure, the MP-DCCP connection  either <bcp14>MUST</bcp14> fall back to regular DCCP or <bcp14>MUST</bcp14> close the connection. Further details are specified in <xref target="fallback"/>.</t>
      </section>
      <section anchor="MP_OPT">
        <name>Multipath Option</name>
        <t>MP-DCCP uses one single option to signal various multipath-related operations. The format of this Multipath Option is shown in <xref target="ref-mp-option-format"/>.</t>

        <figure anchor="ref-mp-option-format">
          <name>Multipath Option Format</name>
          <artwork><![CDATA[
            1          2          3
 01234567 89012345 67890123 45678901 23456789
+--------+--------+--------+--------+--------+
|00101110| Length | MP_OPT | Value(s) ...
+--------+--------+--------+--------+--------+
 Type=46]]></artwork>
        </figure>

        <t>The fields used by the Multipath Option are described in <xref target="ref-mp-option-list"/>. MP_OPT refers to a Multipath Option.</t>

        <table anchor="ref-mp-option-list">
          <name>MP_OPT Option Types</name>
          <thead>
            <tr>
              <th>Type</th>
              <th>Option Length</th>
              <th>MP_OPT</th>
              <th>Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>0 =MP_CONFIRM</td>
              <td>Confirm reception and processing of an MP_OPT option</td>
            </tr>
            <tr>
              <td>46</td>
              <td>12</td>
              <td>1 =MP_JOIN</td>
              <td>Join subflow to an existing MP-DCCP connection</td>
            </tr>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>2 =MP_FAST_CLOSE</td>
              <td>Close an MP-DCCP connection unconditionally</td>
            </tr>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>3 =MP_KEY</td>
              <td>Exchange key material for MP_HMAC</td>
            </tr>
            <tr>
              <td>46</td>
              <td>9</td>
              <td>4 =MP_SEQ</td>
              <td>Multipath sequence number</td>
            </tr>
            <tr>
              <td>46</td>
              <td>23</td>
              <td>5 =MP_HMAC</td>
              <td>Hash-based message authentication code for MP-DCCP</td>
            </tr>
            <tr>
              <td>46</td>
              <td>12</td>
              <td>6 =MP_RTT</td>
              <td>Transmit RTT values and calculation parameters</td>
            </tr>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>7 =MP_ADDADDR</td>
              <td>Advertise one or more additional addresses/ports</td>
            </tr>
            <tr>
              <td>46</td>
              <td>8</td>
              <td>8 =MP_REMOVEADDR</td>
              <td>Remove one or more addresses/ports</td>
            </tr>
            <tr>
              <td>46</td>
              <td>4</td>
              <td>9 =MP_PRIO</td>
              <td>Change subflow priority</td>
            </tr>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>10 =MP_CLOSE</td>
              <td>Close an MP-DCCP connection</td>
            </tr>
            <tr>
              <td>46</td>
              <td>var</td>
              <td>11 =MP_EXP</td>
              <td>Experimental option for private use</td>
            </tr>
            <tr>
              <td>46</td>
              <td>TBD</td>
              <td>&gt;11</td>
              <td>(available for future Multipath Options)</td>
            </tr>
          </tbody>
        </table>
        <t>Future Multipath Options could be defined in a later version of or extension to this specification.</t>
        <t>These operations are largely inspired by the signals defined in <xref target="RFC8684"/>. The procedures for handling faulty or unknown Multipath Options are described in <xref target="fallback"/>.</t>
        <section anchor="MP_CONFIRM">
          <name>MP_CONFIRM</name>
	  <t>Some Multipath Options require confirmation from the remote peer (see <xref target="ref-mp-option-confirm"/>) for which MP_CONFIRM is specified.
	  </t>
	  
          <figure anchor="ref-mp-confirm-format">
            <name>Format of the MP_CONFIRM Option</name>
            <artwork><![CDATA[
            1          2          3           4          5
 01234567 89012345 67890123 45678901 23456789 01234567 89012345
+--------+--------+--------+--------+--------+--------+--------+
|00101110|  var   |00000000| List of confirmations ...
+--------+--------+--------+--------+--------+--------+--------+
 Type=46   Length  MP_OPT=0]]></artwork>
          </figure>

	  <t>
Multipath Options that require confirmation will be retransmitted by the sender until an MP_CONFIRM is received or the confirmation of options is considered irrelevant because the data contained in the options has already been replaced by newer information.
	    </t>
	  
<t> This can happen, for example, with an MP_PRIO option if the path prioritization
is changed while the previous prioritization has not yet been confirmed. The further processing
of the Multipath Options in the receiving host is not the subject of MP_CONFIRM.</t>
          <t>Multipath Options could arrive out of order; therefore, Multipath Options defined in <xref target="ref-mp-option-confirm"/>
<bcp14>MUST</bcp14> be sent in a DCCP datagram with MP_SEQ (see <xref target="MP_SEQ"/>). This allows a receiver to identify whether
Multipath Options are associated with obsolete datasets (information carried in the option header) that would otherwise conflict with newer datasets. In the case of MP_ADDADDR or MP_REMOVEADDR, the same dataset is identified based on AddressID, whereas the same dataset for MP_PRIO is identified by the subflow in use. An outdated
multipath Option is detected at the receiver if a previous Multipath Option referring to the same dataset contained a higher sequence number
in the MP_SEQ. An MP_CONFIRM <bcp14>MAY</bcp14> be generated for Multipath Options that are identified as outdated.</t>
          <t>Similarly, an MP_CONFIRM could arrive out of order. The associated
MP_SEQ received <bcp14>MUST</bcp14> be echoed to ensure that the most recent Multipath Option is confirmed. This protects from inconsistencies that could occur, e.g., if three MP_PRIO options are sent one after
the other on one path in order to first set the path priority to 0, then to 1, and finally to 0 again. Without an associated
MP_SEQ, a loss of the third MP_PRIO option and a loss of the MP_CONFIRM of the second update and the third update would
cause the sender to incorrectly interpret that the priority value was set to 0 without recognizing that the receiver has applied
priority value 1.</t>
          <t>The length of the MP_CONFIRM option and the path over which the option is sent depend on the confirmed Multipath Options and the received
MP_SEQ, which are both copied verbatim and appended as a list of confirmations. The list is structured by first listing the received
MP_SEQ followed by the related Multipath Option or options to confirm. The same rules apply when Multipath Options with different MP_SEQs are confirmed at once.
This could happen if the following are received in short succession: a datagram with MP_PRIO and a first MP_SEQ_1 and another datagram with MP_ADDADDR and a second MP_SEQ_2. In this case, the structure described above is concatenated resulting in MP_SEQ_2 + MP_ADDADDR + MP_SEQ_1 + MP_PRIO.
The order of the confirmed Multipath Options in the list of confirmations <bcp14>MUST</bcp14> reflect the incoming order at the host who sends the MP_CONFIRM, with the most
recent suboption received listed first. This could allow the host receiving the MP_CONFIRM to verify that the options were applied in the correct order
and to take countermeasures if they were not, e.g., if an MP_REMOVEADDR overtakes an MP_ADDADDR that refers to the same dataset.</t>
          <table anchor="ref-mp-option-confirm">
            <name>Multipath Options Requiring Confirmation</name>
            <thead>
              <tr>
                <th>Type</th>
                <th>Option Length</th>
                <th>MP_OPT</th>
                <th>MP_CONFIRM Sending Path</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>46</td>
                <td>var</td>
                <td>7 =MP_ADDADDR</td>
                <td>Any available</td>
              </tr>
              <tr>
                <td>46</td>
                <td>4</td>
                <td>8 =MP_REMOVEADDR</td>
                <td>Any available</td>
              </tr>
              <tr>
                <td>46</td>
                <td>4</td>
                <td>9 =MP_PRIO</td>
                <td>Any available</td>
              </tr>
            </tbody>
          </table>
          <t>An example to illustrate the MP-DCCP confirm procedure for the MP_PRIO option is shown in <xref target="ref-mp-dccp-confirm-good"/>. Host A sends a 
DCCP-Request on path A2-B2 with an MP_PRIO option with value 1 and an associated sequence number of 1. Host B replies on the same path in 
this instance (any path can be used) with a DCCP-Response containing the MP_CONFIRM option and a list containing the original sequence number (1)
	  together with the associated option (MP_PRIO).</t>
	  
          <figure anchor="ref-mp-dccp-confirm-good">
            <name>Example MP_CONFIRM Procedure</name>
            <artwork><![CDATA[
          Host A                                     Host B
------------------------                     ------------------------
Address A1    Address A2                     Address B1    Address B2
----------    ----------                     ----------    ----------
     |             |                                   |       |
     |             | DCCP-Request(seqno 1) + MP_PRIO(1)|       |
     |             |------------------------------------------>|
     |             |                                   |       |
     |             | DCCP-Response +                   |       |
     |             |<---- MP_CONFIRM(seqno 1, MP_PRIO) --------|
     |             |                                   |       |]]></artwork>
          </figure>
          <t>A second example that illustrates the same MP-DCCP confirm procedure but where an out-of-date option is also delivered is shown in <xref target="ref-mp-dccp-confirm-outdated"/>.
Here, the first DCCP-Data is sent from Host A to Host B with option MP_PRIO set to 4. Host A subsequently sends the second DCCP-Data with option MP_PRIO
set to 1. In this case, the delivery of the first MP_PRIO is delayed in the network between Host A and Host B and arrives after the second MP_PRIO. Host B
ignores this second MP_PRIO as the associated sequence number is earlier than the first. Host B sends a DCCP-Ack with sequence number 2 to confirm the receipt of the MP_PRIO(1).</t>
          <figure anchor="ref-mp-dccp-confirm-outdated">
            <name>Example MP_CONFIRM Procedure with an Outdated Suboption</name>
            <artwork><![CDATA[
          Host A                                     Host B
------------------------                     ------------------------
Address A1    Address A2                     Address B1    Address B2
----------    ----------                     ----------    ----------
     |             |                                   |       |
     |             | DCCP-Data(seqno 1) +  MP_PRIO(4)  |       |
     |             |------------                       |       |
     |             |            \                      |       |
     |             | DCCP-Data(seqno 2) +  MP_PRIO(1)  |       |
     |             |--------------\--------------------------->|
     |             |               \                   |       |
     |             |                -------------------------->|
     |             |                                   |       |
     |             | DCCP-Ack +                        |       |
     |             |<---- MP_CONFIRM(seqno 2, MP_PRIO) --------|
     |             |                                   |       |]]></artwork>
          </figure>
        </section>
        <section anchor="MP_JOIN">
          <name>MP_JOIN</name>

<t>
The MP_JOIN option is used to add a new subflow to an existing MP-DCCP
connection, and a successful establishment of the first subflow using MP_KEY is <bcp14>REQUIRED</bcp14>.
</t>

  <figure anchor="ref-MP_JOIN">
            <name>Format of the MP_JOIN Suboption</name>	    
            <artwork><![CDATA[
            1          2          3
 01234567 89012345 67890123 45678901
+--------+--------+--------+--------+
|00101110|00001100|00000001| Addr ID|
+--------+--------+--------+--------+
| Connection Identifier             |
+--------+--------+--------+--------+
| Nonce                             |
+--------+--------+--------+--------+
 Type=46  Length=12 MP_OPT=1]]></artwork>
          </figure>
	  
          <t>
The CI is the one from the peer host,
which was previously exchanged with the MP_KEY option.
MP_HMAC <bcp14>MUST</bcp14> be set when using MP_JOIN within a DCCP-Response packet; see
<xref target="MP_HMAC"/> for details. Similar to the setup of the first subflow, MP_JOIN also exchanges the Multipath Capable Feature MP_CAPABLE as described in <xref target="mp_capable"/>. This procedure includes the DCCP Confirm principle and thus ensures a reliable exchange of the MP_JOIN in accordance with <xref target="RFC4340" sectionFormat="of" section="6.6.4"/>.</t>
          <t>The MP_JOIN option includes an "Addr ID" (Address ID) generated by the sender of the option, which is used to identify the source
address of this packet, even if the IP header was changed in
transit by a middlebox.  The value of this field is generated
by the sender and <bcp14>MUST</bcp14> map uniquely to a source IP address for the
sending host.  The Address ID allows address removal (<xref target="MP_REMOVEADDR"/>)
without the need to know the source address at the receiver,
thus allowing address removal through NATs.  The Address ID also
allows correlation between new subflow setup attempts and address
signaling (<xref target="MP_ADDADDR"/>), to prevent setting up duplicate subflows
on the same path, if an MP_JOIN and MP_ADDADDR are sent at the same
time.</t>
          <t>The Address IDs of the subflow used in the initial DCCP Request/Response exchange of
the first subflow in the connection are implicit and have the value
zero.  A host <bcp14>MUST</bcp14> store the mappings between Address IDs and
addresses for both itself and the remote host.  An implementation
will also need to know which local and remote Address IDs are
associated with which established subflows for when addresses are
removed from a local or remote host. An Address ID <bcp14>MUST</bcp14> always be unique
over the lifetime of a subflow and can only be reassigned if sender and
receiver no longer have them in use.</t>
<t>The Nonce is a 32-bit random value locally generated for every MP_JOIN option.

Together with the derived key from both hosts' Key Data (as described in <xref target="MP_KEY"/>), the Nonce value builds the basis to calculate the Hash-based Message Authentication Code (HMAC) used in the handshake process (as described in <xref target="handshaking"/>) to avoid replay attacks.</t>
          <t>If the CI cannot be verified by the receiving host during a handshake negotiation, 
the new subflow <bcp14>MUST</bcp14> be closed, as specified in <xref target="fallback"/>.</t>
        </section>
        <section anchor="MP_FAST_CLOSE">
          <name>MP_FAST_CLOSE</name>
          <t>DCCP can send a Close or Reset signal to abruptly close a
connection.  Using MP-DCCP, a regular Close or Reset only has the scope of the
subflow over which a signal was received. 
As such, it will only close the subflow and does not
affect other remaining subflows or the MP-DCCP connection (unless it is the last
subflow).
This permits break-before-make handover between
subflows.</t>
          <t>In order to provide an MP-DCCP-level
"reset" and thus allow the abrupt closure of the MP-DCCP connection, the MP_FAST_CLOSE suboption can be used.</t>
          <figure anchor="ref-MP_FAST_CLOSE">
            <name>Format of the MP_FAST_CLOSE Suboption</name>
            <artwork><![CDATA[
            1          2          3
 01234567 89012345 67890123 45678901 23456789
+--------+--------+--------+--------+--------+
|00101110|  var   |00000010| Key Data ...
+--------+--------+--------+--------+--------+
 Type=46   Length  MP_OPT=2]]></artwork>
          </figure>
          <t>When Host A wants to abruptly close an MP-DCCP connection with Host B, it will send out the MP_FAST_CLOSE. The MP_FAST_CLOSE suboption <bcp14>MUST</bcp14> be sent from Host A on all subflows 
using a DCCP-Reset packet with Reset Code 13. The requirement to send the MP_FAST_CLOSE on all subflows increases the probability that Host B will receive the MP_FAST_CLOSE to take the same action. To protect from an unauthorized shutdown of an MP-DCCP connection, 
the selected Key Data of the peer host during the handshake procedure 
is carried by the MP_FAST_CLOSE option.</t>
          <t>After sending the MP_FAST_CLOSE on all subflows, Host A <bcp14>MUST</bcp14> tear down all subflows, 
and the MP-DCCP connection immediately terminates.</t>
          <t>Upon reception of the first MP_FAST_CLOSE with successfully validated 
Key Data, Host B will send a DCCP-Reset packet response on all subflows to 
Host A with Reset Code 13 to clean potential middlebox states. 
Host B <bcp14>MUST</bcp14> then tear down all subflows and terminate the MP-DCCP connection.</t>
        </section>
        <section anchor="MP_KEY">
          <name>MP_KEY</name>

<t>
MP-DCCP protects against some on-path attacker as further outlined in <xref target="security"/>. The basis of this protection is laid by an initial exchange of keys during the MP-DCCP connection setup, for which MP_KEY is introduced. The basis of this protection is laid by an initial exchange of keys during the MP-DCCP connection setup, for which MP_KEY is introduced.
</t>


	  
          <figure anchor="ref-MP_KEY">
            <name>Format of the MP_KEY Suboption</name>
            <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|0 0 1 0 1 1 1 0|      var      |0 0 0 0 0 0 1 1|     resvd     |
+---------------+---------------+---------------+---------------+
|                     Connection Identifier                     |
+---------------+---------------+---------------+---------------+
|  Key Type (1) |  Key Data (1) |  Key Type (2) |  Key Data (2) |
+---------------+---------------+---------------+---------------+
|  Key Type (3) | ...
+---------------+---------------+
    Type=46          Length         MP_OPT=3]]></artwork>
          </figure>
          <t>The MP_KEY suboption is used to exchange a CI and key material between
hosts (Host A and Host B) for a given connection.
The CI is a unique number in the host for each multipath connection and is generated for inclusion in the first exchange of a connection with MP_KEY.  With the CI, it is possible to connect other DCCP subflows to an MP-DCCP connection with MP_JOIN (<xref target="MP_JOIN"/>). Its size of 32 bits also defines the maximum number of simultaneous MP-DCCP connections in a host to 2<sup>32</sup>.
According to the Key-related elements of the MP_KEY suboption, the Length varies between 17 and 73 bytes for a single-key message and up to
82 bytes when all specified Key Types 0 and 255 are provided. The Key Type field 
specifies the type of the following Key Data. 
	  The set of Key Types are shown in <xref target="ref-key-type-list"/>.</t>
	  
          <table anchor="ref-key-type-list">
            <name>MP_KEY Key Types</name>
            <thead>
              <tr>
                <th>Key Type</th>
                <th>Key Length (bytes)</th>
                <th>Meaning</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>0 =Plain Text</td>
                <td>8</td>
                <td>Plain text Key</td>
              </tr>
              <tr>
                <td>1-254</td>
                <td> </td>
                <td>(available for future Key Types)</td>
              </tr>
              <tr>
                <td>255 =Experimental</td>
                <td>64</td>
                <td>For private use only</td>
              </tr>
            </tbody>
          </table>
          <dl newline="true" spacing="normal">
            <dt>Plain Text:</dt>
            <dd><t>Key Data is exchanged in plain text between hosts (Host A and
            Host B), and the respective key parts (KeyA and KeyB) are used by
            each host to generate the derived key (d-key) by concatenating the
            two parts with the local key in front. That is,</t>
              <dl spacing="normal">
                <dt>Host A:</dt><dd>d-keyA=(KeyA+KeyB)</dd>
                <dt>Host B:</dt><dd>d-keyB=(KeyB+KeyA)</dd>
              </dl>
            </dd>
            <dt>Experimental:</dt>
            <dd><t>This Key Type allows the use of other Key Data and can be used
            to validate other key exchange mechanisms for a possible future
            specification.</t>
            </dd>
          </dl>
          <t>Multiple keys are only permitted in the DCCP-Request message
of the handshake procedure for the first subflow. This allows the hosts to agree
on a single Key Type to be used, as described in <xref target="handshaking"/></t>
          <t>It is possible that not all hosts will support all Key Types, and this specification does not
recommend or enforce the announcement of any particular Key Type within the MP_KEY option as this could have security
implications. However, at least Key Type 0 (Plain Text) <bcp14>MUST</bcp14> be supported for interoperability tests
in implementations of MP-DCCP. If the Key Type cannot be agreed in the handshake procedure, the MP-DCCP connection
<bcp14>MUST</bcp14> fall back to not using MP-DCCP, as indicated in <xref target="fallback"/>.</t>
        </section>
        <section anchor="MP_SEQ">
          <name>MP_SEQ</name>
<t>
DCCP <xref target="RFC4340"/> defines a packet sequencing scheme that continues to apply to the individual DCCP subflows within an MP-DCCP connection. However, for the operation of MP-DCPP, the order of packets within an MP-DCCP connection <bcp14>MUST</bcp14> be known before assigning packets to subflows to apply the received Multipath Options in the correct order or to recognize whether delayed Multipath Options are obsolete. Therefore, MP_SEQ is introduced and can also be used to reorder data packets on the receiver side.
 </t>

	  
          <figure anchor="ref-MP_SEQ">
            <name>Format of the MP_SEQ Suboption</name>
            <artwork><![CDATA[
            1          2          3           4          5
 01234567 89012345 67890123 45678901 23456789 01234567 89012345
+--------+--------+--------+--------+--------+--------+--------+
|00101110|00001001|00000100| Multipath Sequence Number
+--------+--------+--------+--------+--------+--------+--------+
                  |
+--------+--------+
 Type=46  Length=9 MP_OPT=4]]></artwork>
          </figure>
          <t>The MP_SEQ suboption is used for end-to-end 48-bit datagram-based sequence
numbers of an MP-DCCP connection. The initial data sequence
number (IDSN) <bcp14>SHOULD</bcp14> be set randomly <xref target="RFC4086"/>. As with the standard DCCP
sequence number, the data sequence number should not start at zero but at
a random value to make blind session hijacking more difficult; see also
<xref target="RFC4340" sectionFormat="of" section="7.2"/>.</t>
          <t>The MP_SEQ number space is
independent of the path individual sequence number space and <bcp14>MUST</bcp14> be
sent with all DCCP-Data and DCCP-DataACK packets.</t>
          <t>When the sequence number space is exhausted, the sequence number <bcp14>MUST</bcp14>
be wrapped. <xref target="RFC7323"/> provides guidance on selecting an appropriately
sized sequence number space according to the Maximum Segment Lifetime (MSL) of
TCP. 64 bits is the recommended size for TCP to avoid the sequence number
space going through within the segment lifetime. For DCCP, the MSL is the same as that of TCP as specified in <xref section="3.4" target="RFC4340"/>.
Compared to TCP, the sequence number for DCCP is incremented
per packet rather than per byte transmitted. For this reason, the 48 bits
chosen in MP_SEQ are considered sufficiently large per the current
globally routable maximum packet size (MPS) of 1500 bytes, which corresponds to
roughly 375 pebibytes (PiBs) of data within the sequence number space.</t>
        </section>
        <section anchor="MP_HMAC">
          <name>MP_HMAC</name>

	  <t>
 MP-DCCP protects against some on-path attacker as further outlined in <xref target="security"/>. Once an MP-DCCP connection has been established, the MP_HMAC option introduced here provides further protection based on the key material exchanged with MP_KEY when the connection is established.
	  </t>
	  
          <figure anchor="ref-MP_HMAC">
            <name>Format of the MP_HMAC Suboption</name>
            <artwork><![CDATA[
            1          2          3           4
 01234567 89012345 67890123 45678901 23456789 01234567
+--------+--------+--------+--------+--------+--------+
|00101110|00010111|00000101| HMAC-SHA256 (20 bytes) ...
+--------+--------+--------+--------+--------+--------+
 Type=46  Length=23 MP_OPT=5]]></artwork>
          </figure>
          <t>The MP_HMAC suboption is used to provide authentication for the
	  MP_ADDADDR and MP_REMOVEADDR suboptions. In addition, it provides
authentication for subflows joining an existing MP_DCCP connection,
as described in the second and third step of the handshake of a
subsequent subflow in <xref target="handshaking"/>. For this specification of MP-DCCP,
the HMAC code is generated according to <xref target="RFC2104"/> in combination
with the SHA-256 hash algorithm described in <xref target="RFC6234"/>, with the
output in big-endian format truncated to the leftmost 160 bits (20 bytes). It is possible
that other versions of MP-DCCP will define other hash algorithms in the future.</t>
          <t>The "Key" used for the HMAC computation is the derived key (d-keyA for Host A or d-KeyB for Host B)
described in <xref target="MP_KEY"/>, while the HMAC "Message" for MP_JOIN, MP_ADDADDR, and MP_REMOVEADDR must be calculated in both hosts in order to protect the Multipath Option when sending and to validate the Multipath Option when receiving; it is a concatenation of:</t>
          <ul>
            <li>
              <t>For MP_JOIN: The Nonces of the MP_JOIN messages for which
              authentication shall be performed. Depending on whether Host A
              or Host B performs the HMAC-SHA256 calculation, it is carried
              out as follows: </t>
              <ul>
                <li>
                  <t>MP_HMAC(A) = HMAC-SHA256(Key=d-keyA, Msg=RA+RB)</t>
                </li>
                <li>
                  <t>MP_HMAC(B) = HMAC-SHA256(Key=d-keyB, Msg=RB+RA)</t>
                </li>
              </ul>
            </li>
          </ul>
          <t>A usage example is shown in <xref target="ref-mp-dccp-handshaking"/>.</t>
          <ul>
            <li>	      
              <t>For MP_ADDADDR: The Address ID and Nonce with an associated IP
              address and a port, if defined; otherwise, 2 bytes of value 0. The IP
              address and port <bcp14>MUST</bcp14> be used in network byte
              order (NBO). Depending on whether Host A or Host B performs the
              HMAC-SHA256 calculation, it is carried out as follows: </t>
              <ul>
                <li>
                  <t>MP_HMAC(A) = HMAC-SHA256(Key=d-keyA, Msg=Address
                  ID+Nonce+NBO(IP)+NBO(Port))</t>
                </li>
                <li>
                  <t>MP_HMAC(B) = HMAC-SHA256(Key=d-keyB, Msg=Address
                  ID+Nonce+NBO(IP)+NBO(Port))</t>
                </li>
              </ul>
            </li>
            <li>
              <t>For MP_REMOVEADDR: Solely the Address ID.  Depending on
              whether Host A or Host B performs the HMAC-SHA256 calculation,
              it is carried out as follows: </t>
              <ul>
                <li>
                  <t>MP_HMAC(A) = HMAC-SHA256(Key=d-keyA, Msg=Address ID+Nonce)</t>
                </li>
                <li>
                  <t>MP_HMAC(B) = HMAC-SHA256(Key=d-keyB, Msg=Address ID+Nonce)</t>
                </li>
              </ul>
            </li>
          </ul>

          <t>MP_JOIN, MP_ADDADDR, and MP_REMOVEADDR can coexist or be used multiple times
within a single DCCP packet. All these Multipath Options require an individual
MP_HMAC option. This ensures that the MP_HMAC is correctly associated.
Otherwise, the receiver cannot validate multiple MP_JOIN, MP_ADDADDR, or
MP_REMOVEADDR options. Therefore, an MP_HMAC <bcp14>MUST</bcp14> directly follow its associated Multipath
Option. In the likely case of sending an MP_JOIN together with an MP_ADDADDR, this
results in concatenating MP_JOIN + MP_HMAC_1 + MP_ADDADDR + MP_HMAC_2, whereas the
first MP_HMAC_1 is associated with the MP_JOIN and the second MP_HMAC_2 is associated with the
MP_ADDADDR suboption.</t>
          <t>On the receiver side, the HMAC validation of the suboptions <bcp14>MUST</bcp14> be carried out according to
the sending sequence in which the associated MP_HMAC follows a suboption. If the suboption
cannot be validated by a receiving host because the HMAC validation fails (HMAC is wrong or missing), the subsequent handling depends
on which suboption was being verified. If the suboption to be authenticated was either
MP_ADDADDR or MP_REMOVEADDR, the receiving host <bcp14>MUST</bcp14> silently ignore it (see Sections <xref target="MP_ADDADDR" format="counter"/> and <xref target="MP_REMOVEADDR" format="counter"/>). 
If the suboption to be authenticated was MP_JOIN, the subflow <bcp14>MUST</bcp14> be closed (see <xref target="fallback"/>).</t>
          <t>In the event that an MP_HMAC cannot be associated with a suboption, this MP_HMAC <bcp14>MUST</bcp14> be ignored, unless
it is a single MP_HMAC that was sent in a DCCP-Ack corresponding to a DCCP response packet with MP_JOIN (see the penultimate arrow in <xref target="ref-mp-dccp-handshaking"/>).</t>
        </section>
        <section anchor="MP_RTT">
          <name>MP_RTT</name>

 <t>The MP_RTT suboption is used to transmit RTT values and Age (represented in milliseconds) that belong to the path over which this information is transmitted. This information is useful for the receiving host to calculate the RTT difference between the subflows and to estimate whether missing data has been lost.</t>
	  
          <figure anchor="ref-MP_RTT">
            <name>Format of the MP_RTT Suboption</name>
            <artwork><![CDATA[
            1          2          3           4          5
 01234567 89012345 67890123 45678901 23456789 01234567 89012345
+--------+--------+--------+--------+--------+--------+--------+
|00101110|00001100|00000110|RTT Type| RTT
+--------+--------+--------+--------+--------+--------+--------+
         | Age                               |
+--------+--------+--------+--------+--------+
 Type=46  Length=12 MP_OPT=6]]></artwork>
          </figure>
         
          <t>The RTT and Age information is a 32-bit integer. This covers a period of
approximately 1193 hours.</t>
          <t>The Field RTT type indicates the type of RTT estimation, according to the following description:</t>
          <dl newline="true">
            <dt>Raw RTT (=0)</dt>
            <dd>
              <t>Raw RTT value of the last Datagram round trip.</t>
            </dd>
            <dt>Min RTT (=1)</dt>
            <dd>
              <t>Min RTT value over a given period.</t>
            </dd>
            <dt>Max RTT (=2)</dt>
            <dd>
              <t>Max RTT value over a given period.</t>
            </dd>
            <dt>Smooth RTT (=3)</dt>
            <dd>
              <t>Averaged RTT value over a given period.</t>
            </dd>
          </dl>

          <t>Each CCID specifies the algorithms and period applied for their corresponding RTT estimations. The availability of the above-described types, to be used in the MP_RTT option, depends on the CCID implementation in place.</t>
          <dl newline="false">
            <dt>Age:</dt>
            <dd>
              <t>The Age parameter defines the time difference between now --
              the creation of the MP_RTT option -- and the conducted RTT
              measurement in milliseconds. If no previous measurement exists,
              e.g., when initialized, the value is 0.</t>
            </dd>
          </dl>

          <t>An example of a flow showing  the exchange of path individual 
RTT information is provided in
<xref target="ref-MP_RTT_example"/>. 
RTT1 refers to the first path and RTT2 to the second path. The
RTT values could be extracted from the sender's congestion control algorithm and are conveyed to the receiving host using the MP_RTT suboption. With the reception of RTT1
and RTT2, the receiver is able to calculate the path_delta that corresponds to
the absolute difference of both values.
In the case where the path individual RTTs are symmetric in the down-link and up-link directions and there is no jitter, packets with missing sequence number MP_SEQ, e.g., in a reordering process, can be assumed lost after path_delta/2.</t>
          <figure anchor="ref-MP_RTT_example">
            <name>Exemplary Flow of MP_RTT Exchange and Usage</name>
            <artwork><![CDATA[
MP-DCCP                   MP-DCCP
Sender                    Receiver
+--------+  MP_RTT(RTT1)  +-------------+
|   RTT1 |----------------|             |
|        |                | path_delta= |
|        |  MP_RTT(RTT2)  | |RTT1-RTT2| |
|   RTT2 |----------------|             |
+--------+                +-------------+]]></artwork>
          </figure>
        </section>
        <section anchor="MP_ADDADDR">
          <name>MP_ADDADDR</name>
          <t>The MP_ADDADDR suboption announces additional addresses (and, optionally,
port numbers) by which a host can be reached. This can be sent at any
time during an existing MP-DCCP connection, when the sender wishes to
enable multiple paths and/or when additional paths become available.
Multiple instances of this suboption within a packet 
can simultaneously advertise new addresses.</t>
          <t>The Length is variable depending on the address family (IPv4 or IPv6) and whether a port number is
used. This field is in the range between 12 and 26 bytes.</t>
          <t>The Nonce is a 32-bit random value that is generated locally for
each MP_ADDADDR option and is used in the HMAC calculation process
to prevent replay attacks.</t>
          <t>The final 2 bytes optionally specify the DCCP port number to
use, and their presence can be inferred from the length of the option.
Although it is expected that the majority of use cases will use the
same port pairs as used for the initial subflow (e.g., port 80
remains port 80 on all subflows, as does the ephemeral port at the
client), there could be cases (such as port-based load balancing) where
the explicit specification of a different port is required.  If no
port is specified, the receiving host <bcp14>MUST</bcp14> assume that any attempt to
connect to the specified address uses the port already used by the
subflow on which the MP_ADDADDR signal was sent.</t>
          <t>Along with the MP_ADDADDR option, an MP_HMAC option <bcp14>MUST</bcp14> be sent for
authentication. The truncated HMAC parameter present in this MP_HMAC
option is the leftmost 20 bytes of an HMAC, negotiated and calculated
as described in <xref target="MP_HMAC"/>. Similar to MP_JOIN,
the key for the HMAC algorithm will be d-KeyA when the message is transmitted
by Host A and d-KeyB when transmitted by Host B.  These are the keys that were exchanged and
selected in the original MP_KEY handshake. The message for the HMAC is
the Address ID, Nonce, IP address, and port number that precede the HMAC in the
MP_ADDADDR option.  If the port number is not present in the MP_ADDADDR option,
the HMAC message will include 2 bytes of value zero.
The rationale for the HMAC is to prevent unauthorized entities from
injecting MP_ADDADDR signals in an attempt to hijack a connection.
Additionally, note that the presence of this HMAC prevents the
address from being changed in flight unless the key is known by an
intermediary.  If a host receives an MP_ADDADDR option for which it
cannot validate the HMAC, it <bcp14>MUST</bcp14> silently ignore the option.</t>
          <t>The presence of an MP_SEQ (<xref target="MP_SEQ"/>) <bcp14>MUST</bcp14> be ensured in a DCCP datagram
in which MP_ADDADDR is sent, as described in <xref target="MP_CONFIRM"/>.</t>
          <figure anchor="ref-MP_ADDADDR">
            <name>Format of the MP_ADDADDR Suboption</name>
            <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------+-------+---------------+
|0 0 1 0 1 1 1 0|      var      |0 0 0 0 0 1 1 1|  Address ID   |
+---------------+---------------+-------+-------+---------------+
|                             Nonce                             |
+-------------------------------+-------------------------------+
|          Address (IPv4 - 4 bytes / IPv6 - 16 bytes)           |
+-------------------------------+-------------------------------+
|   Port (2 bytes, optional)    | + MP_HMAC option
+-------------------------------+
     Type=46         Length         MP_OPT=7]]></artwork>
          </figure>
          <t>Each address has an Address ID that could be used for uniquely
identifying the address within a connection for address removal.
Each host maintains a list of unique Address IDs, and it manages these as it wishes. The
Address ID is also used to identify MP_JOIN options (see <xref target="MP_JOIN"/>)
relating to the same address, even when address translators are in use.
The Address ID <bcp14>MUST</bcp14> uniquely identify the address for the sender of the
option (within the scope of the connection); the mechanism for
allocating such IDs is implementation specific.</t>
          <t>All Address IDs learned via either MP_JOIN or MP_ADDADDR can be stored
by the receiver in a data structure that gathers all the
Address-ID-to-address mappings for a connection (identified by a CI
pair). In this way, there is a stored mapping between the Address ID,
the observed source address, and the CI pair for future processing of control
information for a connection. Note that an implementation
<bcp14>MAY</bcp14> discard incoming address advertisements. Reasons for this are, for example:</t>
          <ul>
            <li>
              <t>to avoid the required mapping state, or</t>
            </li>
            <li>
              <t>because advertised addresses are of no use to it.</t>
            </li>
          </ul>
          <t>Possible scenarios in which this applies are the lack of resources to store
a mapping or when IPv6 addresses are advertised even though the host only
supports IPv4. Therefore, a host <bcp14>MUST</bcp14> treat address announcements as soft state.
However, a sender <bcp14>MAY</bcp14> choose to update the announcements periodically to
overcome temporary limitations.</t>
          <t>A host
<bcp14>MAY</bcp14> advertise private addresses, e.g., because there is a 
NAT on the path.  It is
desirable to allow this as there could be cases where both hosts
have additional interfaces on the same private network. The advertisement
of broadcast or multicast IP addresses <bcp14>MUST</bcp14> be ignored by the recipient of
this option, as it is not permitted according to the unicast principle of the
basic DCCP.</t>
          <t>The MP_JOIN handshake used to
create a new subflow (<xref target="MP_JOIN"/>) provides mechanisms to minimize
security risks.  The MP_JOIN message contains a 32-bit CI that
uniquely identifies a connection to the receiving host. If the
CI is unknown, the host <bcp14>MUST</bcp14> send a DCCP-Reset.</t>
          <t>Further security considerations around the issue of
MP_ADDADDR messages that accidentally misdirect, or maliciously direct,
new MP_JOIN attempts are discussed in <xref target="security"/>.
If a sending host of an MP_ADDADDR knows that no incoming subflows can
be established at a particular address, an MP_ADDADDR <bcp14>MUST NOT</bcp14>
announce that address unless the sending host has new knowledge about
the possibility to do so. This information can be obtained from local
firewall or routing settings, knowledge about availability of an external
NAT or a firewall, or connectivity checks performed by the
host/application.</t>
          <t>The reception of an MP_ADDADDR message is acknowledged using MP_CONFIRM
(<xref target="MP_CONFIRM"/>). This ensures a reliable exchange of address
information.</t>
          <t>A host that receives an MP_ADDADDR but finds
that the IP address and port number is unsuccessful at connection setup <bcp14>SHOULD NOT</bcp14> perform
further connection attempts to this address/port combination for this
connection to save resources. However, if a sender wishes to trigger a new incoming
connection attempt on a previously advertised address/port combination, they 
can refresh the MP_ADDADDR information by sending the option again.</t>
          <t>A host <bcp14>MAY</bcp14> send an MP_ADDADDR message with an already-assigned Address
ID using the IP address previously assigned to this Address ID. The new
MP_ADDADDR could have the same port number or a different port number. The
receiver <bcp14>MUST</bcp14> silently ignore the MP_ADDADDR if the IP address is not the
same as that previously assigned to this Address ID. A host wishing to
replace an existing Address ID <bcp14>MUST</bcp14> first remove the existing one
(<xref target="MP_REMOVEADDR"/>).</t>
        </section>
        <section anchor="MP_REMOVEADDR">
          <name>MP_REMOVEADDR</name>
          <t>If, during the lifetime of an MP-DCCP connection, a previously announced
address becomes invalid (e.g., if an interface disappears), the
affected host <bcp14>SHOULD</bcp14> announce this. The peer can remove a previously 
added address with an Address ID from a connection
using the Remove Address (MP_REMOVEADDR) suboption. This
will terminate any subflows currently using that address.</t>
          <t>MP_REMOVEADDR is only used to close already-established subflows that
have an invalid address. Functional flows with a valid address <bcp14>MUST</bcp14> be
closed with a DCCP Close exchange (as with regular DCCP) instead of
using MP_REMOVEADDR. For more information see <xref target="closing"/>.</t>
          <t>The Nonce is a 32-bit random value that is generated locally for
each MP_REMOVEADDR option and is used in the HMAC calculation process
to prevent replay attacks.</t>
          <t>Along with the MP_REMOVEADDR suboption, an MP_HMAC option <bcp14>MUST</bcp14> be sent for
authentication. The truncated HMAC parameter present in this MP_HMAC
option is the leftmost 20 bytes of an HMAC, negotiated and calculated
as described in <xref target="MP_HMAC"/>. Similar to MP_JOIN,
the key for the HMAC algorithm will be d-KeyA when the message is transmitted by Host A and
d-KeyB when transmitted by Host B.  These are the keys that were exchanged and
selected in the original MP_KEY handshake. The message for the HMAC is
the Address ID.</t>
          <t>The rationale for using an HMAC is to prevent unauthorized entities from
injecting MP_REMOVEADDR signals in an attempt to hijack a connection.
Additionally, note that the presence of this HMAC prevents the
address from being modified in flight unless the key is known by an
intermediary.  If a host receives an MP_REMOVEADDR option for which it
cannot validate the HMAC, it <bcp14>MUST</bcp14> silently ignore the option.</t>
          <t>A receiver <bcp14>MUST</bcp14> include an MP_SEQ (<xref target="MP_SEQ"/>) in a DCCP datagram that sends
an MP_REMOVEADDR. Further details are given in <xref target="MP_CONFIRM"/>.</t>
          <t>The reception of an MP_REMOVEADDR message is acknowledged using MP_CONFIRM
(<xref target="MP_CONFIRM"/>). This ensures a reliable exchange of address
information. To avoid inconsistent states, the sender releases 
the Address ID only after MP_REMOVEADDR has been confirmed.</t>
          <t>The sending and receiving of this message <bcp14>SHOULD</bcp14> trigger the closing procedure
described in <xref target="RFC4340"/> between the client and the server on the affected
subflow(s), if possible. This helps remove middlebox state before
removing any local state.</t>
          <t>Address removal is done by the Address ID to allow the use of NATs and other
middleboxes that rewrite source addresses.  If there is no address
at the requested Address ID, the receiver will silently ignore the request.</t>
          <figure anchor="refMP_REMOVEADDR">
            <name>Format of the MP_REMOVEADDR Suboption</name>
            <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|0 0 1 0 1 1 1 0|0 0 0 0 0 1 0 0|0 0 0 0 1 0 0 0|   Address ID  |
+---------------+---------------+---------------+---------------+
|                             Nonce                             |
+-------------------------------+-------------------------------+
     Type=46        Length=8         MP_OPT=8

-> followed by the MP_HMAC option]]></artwork>
          </figure>
        </section>
        <section anchor="MP_PRIO">
          <name>MP_PRIO</name>
          <t>The path priority signaled with the MP_PRIO option provides hints 
for the packet scheduler when making decisions about which path to use for 
payload traffic.
When a single specific path from the set of available
paths is treated with higher priority compared to the others
when making scheduling decisions for payload traffic, a host can 
signal such change in priority to the peer.
This could be used when there are different costs for
using different paths (e.g., Wi-Fi is free while cellular has a limit on
volume, and 5G has higher energy consumption). The priority of a path
could also change, for example, when a mobile host runs out
of battery, and the usage of only a single path may be the preferred choice
of the user.</t>
          <t>The MP_PRIO suboption, shown below, can be used to set a priority value
for the subflow over which the suboption is received.</t>
          <figure anchor="ref-MP_PRIO">
            <name>Format of the MP_PRIO Suboption</name>
	    
            <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|0 0 1 0 1 1 1 0|0 0 0 0 0 1 0 0|0 0 0 0 1 0 0 1|(resvd)| prio  |
+---------------+---------------+---------------+---------------+
    Type=46         Length=4        MP_OPT=9]]></artwork>
          </figure>
          <t>The following values are available for the Prio field:</t>
          <ul>
            <li>
              <t>0: Do not use. The path is not available.</t>
            </li>
            <li>
              <t>1: Standby: Do not use this path for traffic scheduling if another
   path (secondary or primary) is available. The path will only be used if 
   other secondary or primary paths are not established.</t>
            </li>
            <li>
              <t>2: Secondary: Do not use this path for traffic scheduling if the other
   paths are good enough. The path will be used occasionally for increasing 
   the available capacity temporarily, e.g., when primary paths are 
   congested or are not available. This is the recommended setting for
   paths that have costs or data caps as these paths will be used less
   frequently then primary paths.</t>
            </li>
            <li>
              <t>3 - 15: Primary: The path can be used for packet scheduling decisions. The 
   priority number indicates the relative priority of one path over the 
   other for primary paths. Higher numbers indicate higher priority. 
   The peer should consider sending traffic first over higher priority paths. 
   This is the recommended setting for paths that do not have a cost or 
   data caps associated with them as these paths will be frequently used.</t>
            </li>
          </ul>
          <t>Example use cases include:</t>
          <ol><li>
	    
              <t>Setting the Wi-Fi path to Primary and Cellular path to Secondary. In this case,
   Wi-Fi will be used and Cellular will be used only if the Wi-Fi path is congested or not
   available. Such setting results in using the Cellular path only temporally, 
   if more capacity is needed than the Wi-Fi path can provide, indicating a 
   clear priority of the Wi-Fi path over the Cellular due to, e.g., cost reasons.</t>
            </li>
            <li>
              <t>Setting the Wi-Fi path to Primary and Cellular path to Standby. In this case, Wi-Fi
   will be used and Cellular will be used only if the Wi-Fi path is not available.</t>
            </li>
            <li>
              <t>Setting the Wi-Fi path to Primary and Cellular path to Primary. In this case,
   both paths can be used when making packet scheduling decisions.</t>
            </li>
          </ol>
          <t>If not specified, the default behavior is to always use a path for 
packet scheduling decisions (MP_PRIO=3), when the path has been established and 
added to an existing MP-DCCP connection. At least one path ought to have an 
MP_PRIO value greater than or equal to one for it to be allowed to send on the 
connection. It is <bcp14>RECOMMENDED</bcp14> to update at least one path to a non-zero MP_PRIO
value when an MP-DCCP connection enters a state where all paths remain with an
MP_PRIO value of zero. This helps an MP-DCCP connection to 
schedule when the multipath scheduler strictly respects MP_PRIO value 0.
To ensure reliable transmission, the MP_PRIO suboption <bcp14>MUST</bcp14> be acknowledged via an MP_CONFIRM 
(see <xref target="ref-mp-option-confirm"/>).</t>
<t>The relative ratio of the primary path values 3-15 depends on the path usage strategy, which is described in more detail in <xref target="path_usage_strategy"/>.
In the case of path mobility (<xref target="path_mobility"/>), only one path can be used at a time and <bcp14>MUST</bcp14> have the highest available priority value. That also includes the prio numbers 1 and 2. In the other case of concurrent path usage (<xref target="concurrent_usage"/>), the definition is up to the multipath scheduler logic.</t>
          <t>An MP_SEQ (<xref target="MP_SEQ"/>) <bcp14>MUST</bcp14> be present in a DCCP datagram
in which the MP_PRIO suboption is sent. Further details are given in <xref target="MP_CONFIRM"/>.</t>
        </section>
        <section anchor="MP_CLOSE">
          <name>MP_CLOSE</name>

	  <t>
	    The mechanism available in DCCP <xref target="RFC4340"/> for closing a connection cannot give an indication for closing an MP-DCCP connection, which typically contains several DCCP subflows; therefore, one cannot conclude from the closing of a subflow to the closing of an MP-DCCP connection. This is solved by introducing MP_CLOSE.
	  </t>

	  
          <figure anchor="ref-MP_CLOSE">
            <name>Format of the MP_CLOSE Suboption</name>
            <artwork><![CDATA[
            1          2          3
 01234567 89012345 67890123 45678901 23456789
+--------+--------+--------+--------+--------+
|00101110|  var   |00001010| Key Data ...
+--------+--------+--------+--------+--------+
 Type=46   Length  MP_OPT=10]]></artwork>
          </figure>
          <t>An MP-DCCP connection can be gracefully closed by sending an MP_CLOSE to the peer host. 
On all subflows, the regular termination procedure described in <xref target="RFC4340"/> 
<bcp14>MUST</bcp14> be initiated using MP_CLOSE in the initial packet (either a DCCP-CloseReq or a DCCP-Close). 
When  a DCCP-CloseReq is used, the following DCCP-Close <bcp14>MUST</bcp14> also carry the MP_CLOSE 
to avoid keeping a state in the sender of the DCCP-CloseReq. 
At the initiator of the DCCP-CloseReq, all sockets, including the MP-DCCP connection socket,
transition to CLOSEREQ state. To protect from unauthorized shutdown of a multipath connection, the selected Key Data of 
the peer host <bcp14>MUST</bcp14> be included in the MP_CLOSE option during the handshake procedure and <bcp14>MUST</bcp14> be validated by the peer host. 
Please note that the Key Data sent in DCCP-CloseReq will not be the same as the Key Data sent in DCCP-Close as these originate from different ends of the connection.</t>
          <t>On reception of the first DCCP-CloseReq carrying an MP_CLOSE with valid Key Data, 
or due to a local decision, all subflows transition to the CLOSING state 
before transmitting a DCCP-Close carrying MP_CLOSE. 
The MP-DCCP connection socket on the host sending the DCCP-Close reflects the state of 
the initial subflow during the handshake with MP_KEY option. 
If the initial subflow no longer exists, the state moves immediately to CLOSED.</t>
          <t>Upon reception of the first DCCP-Close carrying an MP_CLOSE with valid Key Data 
at the peer host, all subflows, as well as the MP-DCCP connection socket, 
move to the CLOSED state. After this, a DCCP-Reset with Reset Code 1 
<bcp14>MUST</bcp14> be sent on any subflow in response to a received DCCP-Close containing a valid MP_CLOSE option.</t>
          <t>When the MP-DCCP connection socket is in CLOSEREQ or CLOSED state, new subflow requests using MP_JOIN <bcp14>MUST</bcp14> be ignored.</t>
          <t>Contrary to an MP_FAST_CLOSE (<xref target="MP_FAST_CLOSE"/>), no single-sided abrupt termination is applied.</t>
        </section>
        <section anchor="MP_EXP">
          <name>Experimental Multipath Option MP_EXP for Private Use</name>
          <t>This section reserves a Multipath Option to define and specify any experimental additional feature for improving and optimizing the MP-DCCP protocol. This
option could be applicable to specific environments or scenarios according to potential new requirements and is meant for private use only. MP_OPT 
Feature Number 11 is specified with an exemplary description as below:</t>
          <figure anchor="ref-MP_EXP">
            <name>Format of the MP_EXP Suboption</name>
            <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|0 0 1 0 1 1 1 0|      var      |0 0 0 0 1 0 1 1|     Data      |
+---------------+---------------+---------------+---------------+
|   ...
+---------------------------------------------------------------+
     Type=46         Length         MP_OPT=11]]></artwork>
          </figure>
          <t>The Data field can carry any data according to the foreseen use by the experimenters with a maximum Length of 252 bytes.</t>
        </section>
      </section>
      <section anchor="handshaking">
        <name>MP-DCCP Handshake Procedure</name>
        <t>An example MP-DCCP handshake procedure is shown in <xref target="ref-mp-dccp-handshaking"/>.</t>
        <figure anchor="ref-mp-dccp-handshaking">
	  
          <name>Example MP-DCCP Handshake</name>
          <artwork><![CDATA[
          Host A                                         Host B
------------------------                              ----------
Address A1    Address A2                              Address B1
----------    ----------                              ----------
     |             |                                       |
     |           DCCP-Request + Change R (MP_CAPABLE,...)  |
     |----- MP_KEY(CI-A + KeyA(1), KeyA(2),...) ---------->|
     |<------------------- MP_KEY(CI-B + KeyB) ------------|
     |       DCCP-Response +  Confirm L (MP_CAPABLE, ...)  |
     |             |                                       |
     |   DCCP-Ack  |                                       |
     |---------------------------------------------------->|
     |<----------------------------------------------------|
     |   DCCP-Ack  |                                       |
     |             |                                       |
     |             |DCCP-Request + Change R(MP_CAPABLE,...)|
     |             |--- MP_JOIN(CI-B,RA) ----------------->|
     |             |<------MP_JOIN(CI-A,RB) + MP_HMAC(B)---|
     |             |DCCP-Response+Confirm L(MP_CAPABLE,...)|
     |             |                                       |
     |             |DCCP-Ack                               |
     |             |-------- MP_HMAC(A) ------------------>|
     |             |<--------------------------------------|
     |             |DCCP-Ack                               |]]></artwork>
        </figure>
        <t>The basic initial handshake for the first subflow is as follows:</t>
        <ol>
          <li>
            <t>Host A sends a DCCP-Request with the Multipath Capable Feature change
request and the MP_KEY option with a Host-specific CI-A and a KeyA for
each of the supported Key Types as described in <xref target="MP_KEY"/>. CI-A is a unique identifier during the
lifetime of an MP-DCCP connection.</t>
          </li>
          <li>
            <t>Host B sends a DCCP-Response with a Confirm feature for
MP-Capable and the MP_Key option with a unique Host-specific CI-B and a single Host-specific KeyB.
The type of the key is chosen from the list of supported types
from the previous request.</t>
          </li>
          <li>
            <t>Host A sends a DCCP-Ack to confirm the proper key exchange.</t>
          </li>
          <li>
            <t>Host B sends a DCCP-Ack to complete the handshake and set both connection ends to the OPEN state.</t>
          </li>
        </ol>
        <t>It should be noted that DCCP is protected against corruption of DCCP header data (<xref target="RFC4340" sectionFormat="of" section="9"/>), so no additional mechanisms beyond the general confirmation are required to ensure that the header data has been properly received.</t>
        <t>Host A waits for the final DCCP-Ack from Host B before starting any
establishment of additional subflow connections.</t>
        <t>The handshake for subsequent subflows, based on a successful initial
handshake, is as follows:</t>
        <ol>
          <li>
            <t>Host A sends a DCCP-Request with the Multipath Capable Feature change
            request and the MP_JOIN option with Host B's CI-B, obtained during
            the initial handshake. Additionally, a random Nonce RA is
            transmitted with the MP_JOIN.</t>
          </li>
          <li>
            <t>Host B computes the HMAC of the DCCP-Request and sends a
            DCCP-Response with a Confirm feature option for MP-Capable and the
            MP_JOIN option with the CI-A and a random Nonce RB together with
            the computed MP_HMAC.
	    As specified in <xref target="MP_HMAC"/>,
            the HMAC is calculated by taking the leftmost 20 bytes from the
            SHA-256 hash of an HMAC code that is created by using the Nonce received
            with MP_JOIN(A) and the local Nonce RB as the Message and the derived
            key as the Key, as described in <xref target="MP_KEY"/>: </t>
            <t>MP_HMAC(B) = HMAC-SHA256(Key=d-keyB, Msg=RB+RA)</t>
          </li>
          <li>
            <t>Host A sends a DCCP-Ack with the HMAC computed for the
            DCCP-Response.  As specified in <xref target="MP_HMAC"/>, the HMAC
            is calculated by taking the leftmost 20 bytes from the SHA-256 hash
            of an HMAC code created by using the local Nonce RA and the Nonce
            received with MP_JOIN(B) as message and the derived key described
            in <xref target="MP_KEY"/> as key: </t>
            <t>MP_HMAC(A) = HMAC-SHA256(Key=d-keyA, Msg=RA+RB)</t>
          </li>
          <li>
            <t>Host B sends a DCCP-Ack to confirm the HMAC and to conclude the
            handshake.</t>
          </li>
        </ol>

      </section>
      <section anchor="address-knowledge-exchange">
        <name>Address Knowledge Exchange</name>
        <section anchor="advertising-a-new-path-mpaddaddr">
          <name>Advertising a New Path (MP_ADDADDR)</name>
          <t>When a host (Host A) wants to advertise the availability of a new path, it should use the MP_ADDADDR option (<xref target="MP_ADDADDR"/>) as
shown in the example in <xref target="ref-mp-dccp-add-address"/>. The MP_ADDADDR option passed in the DCCP-Data contains the following parameters:</t>
          <ul>
            <li>
              <t>an identifier (id 2) for the new IP address, which is used as a reference in subsequent control exchanges</t>
            </li>
            <li>
              <t>a Nonce value to prevent replay attacks</t>
            </li>
            <li>
              <t>the IP address of the new path (A2_IP)</t>
            </li>
            <li>
              <t>a pair of bytes specifying the port number associated with this IP address. The value of 00 here indicates that the port number is the same
as that used for the initial subflow address A1_IP.</t>
            </li>
          </ul>
          <t>According to <xref target="MP_ADDADDR"/>, the following options are required in a packet carrying MP_ADDADDR:</t>
          <ul>
            <li>
              <t>the leftmost 20 bytes of the HMAC(A) generated during the initial handshake procedure described in Sections <xref target="handshaking" format="counter"/> and <xref target="MP_HMAC" format="counter"/></t>
            </li>
            <li>
              <t>the MP_SEQ option with the sequence number (seqno 12) for this message, according to <xref target="MP_SEQ"/></t>
            </li>
          </ul>
          <t>Host B acknowledges receipt of the MP_ADDADDR message with a DCCP-Ack containing the MP_CONFIRM option. The parameters supplied in this
response are as follows:</t>
          <ul>
            <li>
              <t>an MP_CONFIRM containing the MP_SEQ number (seqno 12) of the packet carrying the option that we are confirming together with the MP_ADDADDR option</t>
            </li>
            <li>
              <t>the leftmost 20 bytes of the HMAC(B) generated during the initial handshake procedure (<xref target="handshaking"/>)</t>
            </li>
          </ul>
          <figure anchor="ref-mp-dccp-add-address">
            <name>Example MP_ADDADDR Procedure</name>
            <artwork><![CDATA[
          Host A                                         Host B
------------------------                              -----------
Address A1    Address A2                               Address B1
----------    ----------                              -----------
     |             |                                       |
     |   DCCP-Data +  MP_ADDADDR(id 2, Nonce, A2_IP, 00) + |
     |------- MP_HMAC(A) + MP_SEQ(seqno 12) -------------->|
     |             |                                       |
     |   DCCP-Ack + MP_HMAC(B) +                           |
     |<----- MP_CONFIRM(seqno 12, MP_ADDADDR) -------------|]]></artwork>
          </figure>
        </section>
        <section anchor="removing-a-path-mpremoveaddr">
          <name>Removing a Path (MP_REMOVEADDR)</name>
          <t>When a host (Host A) wants to indicate that a path is no longer available, it should use the MP_REMOVEADDR option (<xref target="MP_REMOVEADDR"/>) as
shown in the example in <xref target="ref-mp-dccp-remove-address"/>. The MP_REMOVEADDR option passed in the DCCP-Data contains the following parameters:</t>
          <ul>
            <li>
              <t>an identifier (id 2) for the IP address to remove (A2_IP) and that was specified in a previous MP_ADDADDR message</t>
            </li>
            <li>
              <t>a Nonce value to prevent replay attacks</t>
            </li>
          </ul>
          <t>According to <xref target="MP_REMOVEADDR"/>, the following options are required in a packet carrying MP_REMOVEADDR:</t>
          <ul>
            <li>
              <t>the leftmost 20 bytes of the HMAC(A) generated during the initial handshake procedure described in Sections <xref target="handshaking" format="counter"/> and <xref target="MP_HMAC" format="counter"/></t>
            </li>
            <li>
              <t>the MP_SEQ option with the sequence number (seqno 33) for this message, according to <xref target="MP_SEQ"/></t>
            </li>
          </ul>
          <t>Host B acknowledges receipt of the MP_REMOVEADDR message with a DCCP-Ack containing the MP_CONFIRM option. The parameters supplied in this
response are as follows:</t>
          <ul>
            <li>
              <t>an MP_CONFIRM containing the MP_SEQ number (seqno 33) of the packet carrying the option that we are confirming, together with the MP_REMOVEADDR option</t>
            </li>
            <li>
              <t>the leftmost 20 bytes of the HMAC(B) generated during the initial handshake procedure (<xref target="handshaking"/>)</t>
            </li>
          </ul>
          <figure anchor="ref-mp-dccp-remove-address">
            <name>Example MP_REMOVEADDR Procedure</name>
            <artwork><![CDATA[
          Host A                                         Host B
------------------------                              -----------
Address A1    Address A2                               Address B1
----------    ----------                              -----------
     |             |                                       |
     |   DCCP-Data +  MP_REMOVEADDR(id 2, Nonce) +         |
     |------- MP_HMAC(A) + MP_SEQ(seqno 33) -------------->|
     |             |                                       |
     |   DCCP-Ack + MP_HMAC(B) +                           |
     |<----- MP_CONFIRM(seqno 33, MP_REMOVEADDR) ----------|]]></artwork>
          </figure>
        </section>
      </section>
      <section anchor="closing">
        <name>Closing an MP-DCCP Connection</name>
        <t>When a host wants to close an existing subflow but not the whole MP-DCCP
connection, it <bcp14>MUST</bcp14> initiate the regular DCCP connection termination procedure 
as described in <xref target="RFC4340" sectionFormat="of" section="5.6"/>, i.e., it sends a DCCP-Close/DCCP-Reset on the subflow. This
may be preceded by a DCCP-CloseReq. In the event of an irregular termination of a subflow,
e.g., during subflow establishment, it <bcp14>MUST</bcp14> use an appropriate DCCP-Reset Code as specified by IANA <xref target="DCCP-PARAMETERS"/> for DCCP operations. This could be, for example, sending Reset Code 5 (Option Error) when an MP-DCCP
option provides invalid data or Reset Code 9 (Too Busy) when the maximum number of maintainable paths
is reached. Note that receiving a Reset Code 9 for secondary subflows <bcp14>MUST NOT</bcp14> impact already existing active
subflows. If necessary, these subflows are terminated in a subsequent step using the procedures described in
this section.</t>
        <t>A host terminates an MP-DCCP connection using the DCCP connection termination specified in
<xref target="RFC4340" sectionFormat="of" section="5.5"/> on each subflow with the first packet on each subflow carrying MP_CLOSE (see <xref target="MP_CLOSE"/>).</t>
        <artwork><![CDATA[
Host A                                   Host B
------                                   ------
                                 <-      Optional DCCP-CloseReq +
                                         MP_CLOSE [A's key]
                                         [on all subflows]
DCCP-Close + MP_CLOSE            ->
[B's key] [on all subflows]
                                 <-      DCCP-Reset
                                         [on all subflows]]]></artwork>

        <t>Additionally, an MP-DCCP connection may be closed abruptly using the "fast close"
procedure described in <xref target="MP_FAST_CLOSE"/>, where a DCCP-Reset is sent on all
subflows, each carrying the MP_FAST_CLOSE option.</t>

        <artwork><![CDATA[
Host A                                   Host B
------                                   ------
DCCP-Reset + MP_FAST_CLOSE       ->
[B's key] [on all subflows]
                                 <-      DCCP-Reset
                                         [on all subflows]]]></artwork>

      </section>
      <section anchor="fallback">
        <name>Fallback</name>
        <t>When a subflow fails to operate following the intended behavior of the MP-DCCP, it is 
necessary to proceed with a fallback. This may be either falling back 
to regular DCCP <xref target="RFC4340"/> or removing a problematic subflow. The main reasons for 
a subflow failing include: no MP support at the peer host, failure to negotiate the protocol
version, loss of Multipath Options, faulty/non-supported MP-DCCP options, or modification
of payload data.</t>
        <t>At the start of an MP-DCCP connection, the handshake ensures the exchange of the MP-DCCP feature and options and thus ensures that the path is fully MP-DCCP capable. If during the
handshake procedure it appears that DCCP-Request or DCCP-Response
messages do not carry the Multipath Capable Feature, the MP-DCCP connection will not be 
established and the handshake <bcp14>SHOULD</bcp14> fall back to regular DCCP. If this is not 
possible, the connection <bcp14>MUST</bcp14> be closed.</t>
        <t>If the endpoints fail to agree on the protocol version to use during the Multipath
Capable Feature negotiation, the connection <bcp14>MUST</bcp14> either be closed or fall back
to regular DCCP. This is described in <xref target="mp_capable"/>. The protocol version negotiation
distinguishes between negotiation for the initial connection establishment and
the addition of subsequent subflows. If protocol version negotiation is not successful
during the initial connection establishment, the MP-DCCP connection will fall back to regular DCCP.</t>
        <t>The fallback procedure for regular DCCP <bcp14>MUST</bcp14> also be applied if the MP_KEY (<xref target="MP_KEY"/>) Key Type cannot be negotiated.</t>
        <t>If a subflow attempts to join an existing MP-DCCP connection but MP-DCCP options or the Multipath Capable Feature are not present or are faulty in the handshake procedure, that subflow <bcp14>MUST</bcp14> be closed.
This is the case especially if a different MP_CAPABLE version than the originally negotiated
version is used. Reception of a non-verifiable MP_HMAC (<xref target="MP_HMAC"/>) or an invalid
CI used in MP_JOIN (<xref target="MP_JOIN"/>) during flow establishment <bcp14>MUST</bcp14> cause the
subflow to be closed.</t>
        <t>The subflow closing procedure <bcp14>MUST</bcp14> also be applied if a final ACK carrying MP_KEY with the wrong KeyA/KeyB is
received or the MP_KEY option is malformed.</t>
        <t>Another relevant case is when payload data is modified by middleboxes. DCCP uses 
a checksum to protect the data, as described in <xref target="RFC4340" sectionFormat="of" section="9"/>. A checksum will 
fail if the data has been changed in any way. All data from the start of the segment that
failed the checksum onwards cannot be considered trustworthy. As defined by DCCP, if the checksum fails, the receiving endpoint <bcp14>MUST</bcp14> drop the application data and report 
that data as dropped due to corruption using a Data Dropped option (Drop Code 3, 
Corrupt). If data is dropped due to corruption for an MP-DCCP connection, the affected
subflow <bcp14>MAY</bcp14> be closed. The same procedure applies if the Multipath Option is unknown.</t>
      </section>
      <section anchor="state-diagram">
        <name>State Diagram</name>
        <t>The MP-DCCP per subflow state transitions follow the
state transitions defined for DCCP in <xref target="RFC4340"/> to a large extent, with some modifications 
due to the MP-DCCP 4-way handshake and fast close procedures. The state diagram below
shows the most common state transitions.  The diagram is illustrative.
For example, there are arcs (not shown) from several additional states 
	to TIMEWAIT, contingent on the receipt of a valid DCCP-Reset.</t>

        <t>When the state moves from CLOSED to OPEN during the 4-way handshake, the transitioned states remain the same as for DCCP, but it is no longer possible to transmit
application data while in the REQUEST state. The fast close procedure
can be triggered by either the client or the server and results in the transmission
of a Reset packet. The fast close procedure moves the state of the Client and Server
directly to TIMEWAIT and CLOSED, respectively.</t>
        <figure anchor="ref-mp-dccp-state-transition">
          <name>Most Common State Transitions of an MP-DCCP Subflow</name>
          <artwork><![CDATA[
+----------------------------+    +------------------------------+
|                            v    v                              |
|                         +----------+                           |
|           +-------------+  CLOSED  +-------------+             |
|           | passive     +----------+   active    |             |
|           |  open                       open     |             |
|           |                          snd Request |             |
|           v                                      v             |
|     +-----------+                           +----------+       |
|     |  LISTEN   |                           | REQUEST  |       |
|     +-----+-----+                           +----+-----+       |
|           | rcv Request             rcv Response |             |
|           | snd Response              snd Ack    |             |
|           v                                      v             |
|     +-----------+                           +----------+       |
|     |  RESPOND  |                           | PARTOPEN |       |
|     +-----+-----+                           +----+-----+       |
|           | rcv Ack             rcv Ack/DataAck  |             |
|           | snd Ack                              |             |
|           |             +-----------+            |             |
|           +------------>|   OPEN    |<-----------+             |
|                         +--+-+-+-+--+                          |
|        server active close | | | |   active close              |
|            snd CloseReq    | | | | or rcv CloseReq             |
|                            | | | |    snd Close                |
|                            | | | |                             |
|     +-----------+          | | | |            +----------+     |
|     | CLOSEREQ  |<---------+ | | +----------->| CLOSING  |     |
|     +-----+-----+            | |              +----+-----+     |
|           | rcv Close        | |         rcv Reset |           |
|           | snd Reset        | |                   |           |
|           |                  | | active FastClose  |           |
|<----------+        rcv Close | | or rcv FastClose  v           |
|   or server active FastClose | | snd Reset    +----+-----+     |
|      or server rcv FastClose | +------------->| TIMEWAIT |     |
|                    snd Reset |                +----+-----+     |
+------------------------------+                     |           |
                                                     +-----------+
                                                 2MSL timer expires]]></artwork>
        </figure>
      </section>
      <section anchor="congestion-control-considerations">
        <name>Congestion Control Considerations</name>
        <t>Senders <bcp14>MUST</bcp14> manage per-path congestion status and avoid 
sending more data on a given path than congestion control allows for each path.</t>
      </section>
      <section anchor="mps">
        <name>Maximum Packet Size Considerations</name>
        <t>A DCCP implementation maintains the maximum packet size (MPS) during operation of a DCCP session. This procedure is specified for single-path DCCP in <xref target="RFC4340" sectionFormat="of" section="14"/>. Without any restrictions, this is adopted for MP-DCCP operations, in particular the Path MTU (PMTU) measurement and the Sender Behavior. The DCCP application interface <bcp14>SHOULD</bcp14> allow the application to discover the current MPS. This reflects the current largest size supported for the data stream that can be used across the set of all active MP-DCCP subflows.</t>
      </section>
      <section anchor="maximum-number-of-subflows-considerations">
        <name>Maximum Number of Subflow Considerations</name>
        <t>MP-DCCP does not support any explicit procedure to negotiate
the maximum number of subflows between endpoints. However, in practical
scenarios, there will be resource limitations on the host
or use cases that do not benefit from additional subflows.</t>
<t>It is <bcp14>RECOMMENDED</bcp14> to limit the number of subflows in implementations and to reject incoming subflow requests with a DCCP-Reset using the Reset Code "too busy" according to <xref target="RFC4340"/> if the resource limit is exceeded or it is known that the multipath connection will not benefit from further subflows. Likewise, it is <bcp14>RECOMMENDED</bcp14> that the host that wants to create the subflows  considers the available resources and possible gains.</t>
        <t>To avoid further inefficiencies with subflows due to short-lived connections, it <bcp14>MAY</bcp14> be useful to delay the start of additional subflows. The decision on the initial number of subflows can be based on the occupancy of the socket buffer and/or the timing.</t>
        <t>While in the socket-buffer-based approach the number of initial subflows can be derived by opening new subflows until their initial windows cover the amount of buffered application data, the timing-based approach delays the start of additional subflows based on a certain time period, load, or knowledge of traffic and path properties. The delay-based approach also provides resilience for low-bandwidth but long-lived applications. All this could also be supported by advanced APIs that signal application traffic requests to the MP-DCCP.</t>
      </section>
      <section anchor="path_usage_strategy">
        <name>Path Usage Strategies</name>
        <t>MP-DCCP can be configured to realize one of several strategies for path usage via selecting one DCCP subflow out of the multiple DCCP subflows within an MP-DCCP connection for data transmission. This can be a dynamic process further facilitated by the means of DCCP and MP-DCCP-defined options such as path preference using MP-PRIO; adding or removing DCCP subflows using MP_REMOVEADDR, MP_ADDADDR, or DCCP-Close/DCCP-Reset; and path metrics such as packet loss rate, congestion window (CWND), or RTT provided by the congestion control algorithm.
Selecting an appropriate method can allow MP-DCCP to realize different path utilization strategies that make MP-DCCP suitable for end-to-end implementation over the Internet or in controlled environments such as Hybrid Access or 5G ATSSS.</t>
        <section anchor="path_mobility">
          <name>Path Mobility</name>
          <t>The path mobility strategy provides the use of a single path with a seamless handover function to continue the connection when the currently used path is deemed unsuitable for service delivery.
Some of the DCCP subflows of an MP-DCCP connection might become inactive due to either the occurrence of certain error conditions (e.g., DCCP timeout, packet loss threshold, RTT threshold, and closed/removed) or adjustments from the MP-DCCP user.
When there is outbound data to send and the primary path becomes inactive (e.g., due to failures) or deprioritized, the MP-DCCP endpoint <bcp14>SHOULD</bcp14> try to send the data through an alternate path with a different source or destination address (depending on the point of failure), if one exists. This process <bcp14>SHOULD</bcp14> respect the path priority configured by the MP_PRIO suboption; otherwise, if the path priority is not available, pick the most divergent source-destination pair from the originally used source-destination pair.</t>

<aside><t>Note: Rules for picking the most appropriate source-destination pair
are an implementation decision and are not specified within this document.
Path mobility is supported in the current Linux reference implementation <xref
target="MP-DCCP.Site"/>.</t></aside>

        </section>
        <section anchor="concurrent_usage">
          <name>Concurrent Path Usage</name>
          <t>Different from a path mobility strategy, the selection between MP-DCCP
subflows is a per-packet decision that is a part of the multipath
scheduling process. This method would allow multiple subflows to be
simultaneously used to aggregate the path resources to obtain higher
connection throughput.</t>
<t>In this scenario, the selection of congestion control, per-packet scheduling,
and a potential reordering method determines a concurrent path utilization
strategy and result in a particular transport characteristic.
A concurrent path usage method uses a scheduling design that could seek to
maximize reliability, maximize throughput, minimize latency, etc.</t>
          <t>Concurrent path usage over the Internet can have implications. When an 
MP-DCCP connection uses two or more paths, there is no guarantee 
that these paths are fully disjoint.  When two (or more) subflows share 
the same bottleneck, using a standard congestion control algorithm could 
result in an unfair distribution of the capacity with the multipath 
connection using more capacity than competing single-path connections.</t>
<t>Multipath TCP uses the coupled congestion control Linked Increases 
Algorithm (LIA) specified in an experimental specification <xref target="RFC6356"/> to solve this problem.  This 
scheme could also be specified for MP-DCCP.  The same applies to 
other coupled congestion control algorithms that have been proposed for 
Multipath TCP such as the Opportunistic Linked Increases Algorithm <xref target="OLIA"/>.</t>
          <t>The specification of scheduling for concurrent multipath and related 
congestion control algorithms and reordering methods for use in the general
Internet are outside the scope of this document. If, and when, the IETF
specifies a method for concurrent usage of multiple paths for the
general Internet, the framework specified in this document could be used to 
provide an IETF-recommended method for MP-DCCP.
 </t>
        </section>
      </section>
    </section>
    <section anchor="security">
      <name>Security Considerations</name>
      <t>Similar to DCCP, MP-DCCP does not provide cryptographic security
guarantees inherently. Thus, if applications need cryptographic security
(integrity, authentication, confidentiality, access control, and
anti-replay protection), the use of IPsec, DTLS over DCCP <xref target="RFC5238"/>, or other
end-to-end security is recommended;
the Secure Real-time Transport Protocol (SRTP) <xref target="RFC3711"/> is one candidate
protocol for authentication. Integrity would be provided if using SRTP together with the encryption of header extensions described in <xref target="RFC6904"/>.</t>
      <t>DCCP <xref target="RFC4340"/> provides protection against hijacking
and limits the potential impact of some denial-of-service attacks, but
DCCP provides no inherent protection against an on-path attacker snooping on data
packets. Regarding the security of MP-DCCP compared to regular DCCP, no additional risks should be introduced. The security objectives for MP-DCCP are:</t>
      <ul>
        <li>
          <t>Provide assurance that the parties involved in an
MP-DCCP handshake procedure are identical to those in the original DCCP connection.</t>
        </li>
        <li>
          <t>Before a path is used, verify that the new advertised path is valid for receiving traffic.</t>
        </li>
        <li>
          <t>Provide replay protection, i.e., ensure that a request to add/remove a
subflow is 'fresh'.</t>
        </li>
        <li>
          <t>Allow a party to limit the number of subflows that it allows.</t>
        </li>
      </ul>
      <t>To achieve these goals, MP-DCCP includes a hash-based handshake
algorithm documented in Sections <xref target="MP_KEY" format="counter"/>, <xref target="MP_HMAC" format="counter"/>, and <xref target="handshaking" format="counter"/>. The
security of the MP-DCCP connection depends on the use of keys that are
shared once at the start of the first subflow and are never sent again
over the network. Depending on the security requirements, different Key Types can
be negotiated in the handshake procedure or must follow the fallback scenario
described in <xref target="fallback"/>. If there are security requirements that go beyond the
capabilities of Key Type 0, then it is <bcp14>RECOMMENDED</bcp14> that Key Type 0 not be enabled
to avoid downgrade attacks that result in the key being exchanged as plain text.
To ease demultiplexing while not revealing
cryptographic material, subsequent subflows use the initially exchanged
CI information. The keys exchanged once at the beginning are
concatenated and used as keys for creating HMACs used on subflow setup, in order to verify
that the parties in the handshake of subsequent subflows are the same as in the original
connection setup. This also provides verification that the peer can
receive traffic at this new address. Replay attacks would still be
possible when only keys are used;
therefore, the handshakes use single-use random numbers (Nonces) for both
parties -- this ensures that the HMAC will never be the same on two handshakes.
Guidance on generating random numbers suitable for use as keys is given
in <xref target="RFC4086"/>. During normal operation, regular DCCP protection
mechanisms (such as the header checksum to protect DCCP headers against
corruption) is designed to provide the same level of protection against attacks on
individual DCCP subflows as exists for regular DCCP.</t>
      <t>As discussed in <xref target="MP_ADDADDR"/>, a host may advertise its private
addresses, but these might point to different hosts in the receiver's
network.  The MP_JOIN handshake (<xref target="MP_JOIN"/>) is designed to ensure that this
does not set up a subflow to the incorrect host.
However, it could still create unwanted DCCP handshake traffic.  This
feature of MP-DCCP could be a target for denial-of-service exploits,
with malicious participants in MP-DCCP connections encouraging the
recipient to target other hosts in the network.  Therefore,
implementations should consider heuristics at both the
sender and receiver to reduce the impact of this.</t>
      <t>As described in <xref target="mps"/>, an MPS is maintained for an MP-DCCP connection.
If MP-DCCP exposes a minimum MPS across all paths,
any change to one path impacts the sender for all paths.
To mitigate attacks that seek to force a low MPS, MP-DCCP
could detect an attempt to reduce the MPS to less than a minimum MPS and then
stop using these paths.</t>
    </section>
    <section anchor="middlebox">
      <name>Interactions with Middleboxes</name>

      <t>Issues from interaction with on-path middleboxes such as NATs, firewalls, proxies,
IDSs, and others have to be considered for all
extensions to standard protocols; otherwise, unexpected reactions of
middleboxes may hinder its deployment. DCCP already provides means to
mitigate the potential impact of middleboxes, in comparison to TCP (see
<xref target="RFC4340" sectionFormat="of" section="16"/>). When both hosts are located behind a NAT or
firewall entity, specific measures have to be applied such as the 
simultaneous-open technique specified in <xref target="RFC5596"/> that updates the asymmetric connection-establishment procedures for DCCP.  Further standardized technologies
addressing middleboxes operating as NATs are provided in <xref target="RFC5597"/>.</t>
      <t><xref target="RFC6773"/> specifies UDP encapsulation for NAT traversal of DCCP sessions,
similar to other UDP encapsulations such as the Stream Control Transmission Protocol (SCTP) <xref target="RFC6951"/>. Future
specifications by the IETF could specify other methods for DCCP encapsulation.</t>
      <t>The security impact of MP-DCCP-aware middleboxes is discussed in <xref target="security"/>.</t>
    </section>
    <section anchor="implementation">
      <name>Implementation</name>
      <t>The approach described above has been implemented in open source across different testbeds, and a new scheduling algorithm has been extensively tested. Also, 
demonstrations of a laboratory setup have been executed and published; see <xref target="MP-DCCP.Site"/>.</t>
    </section>
    <section anchor="iana-considerations">
      <name>IANA Considerations</name>
      <t>This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding the registration of values related to the MP extension of the DCCP protocol 
in accordance with the RFC Required policy in <xref target="RFC8126" sectionFormat="of" section="4.7"/>.  This document defines one new value that has been allocated in the IANA "DCCP Feature Numbers" registry and creates three new registries that have been added in the "Datagram Congestion Control Protocol (DCCP) Parameters" registry group.</t>
      <section anchor="new-multipath-capable-dccp-feature">
        <name>New Multipath Capable DCCP Feature</name>
        <t>Per this document, IANA has assigned a new DCCP feature parameter for negotiating
the support of multipath capability for DCCP sessions between hosts
as described in <xref target="protocol"/>. The following entry in <xref target="ref-add-feature-list"/> has been 
	added to the "Feature Numbers" registry in the DCCP registry group according to <xref target="RFC4340" sectionFormat="of" section="19.4"/>.</t>
	
        <table anchor="ref-add-feature-list">
          <name>Addition to DCCP Feature Numbers Registry</name>
          <thead>
            <tr>
              <th>Number</th>
              <th>Description/Meaning</th>
              <th>Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>10</td>
              <td>Multipath Capable</td>
              <td>RFC 9897</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="new-mp-dccp-version-registry">
        <name>New MP-DCCP Versions Registry</name>
        <t><xref target="mp_capable"/> specifies the new 1-byte entry above that includes a 4-bit part to specify the version of the used MP-DCCP implementation. IANA has created a new "MP-DCCP Versions" registry in the DCCP registry group to track the MP-DCCP version. The initial content of this registry is as follows:</t>
        <table anchor="ref-add-version-list">
          <name>MP-DCCP Versions Registry</name>
          <thead>
            <tr>
              <th>Version</th>
              <th>Value</th>
              <th>Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>0000</td>
              <td>RFC 9897</td>
            </tr>
            <tr>
              <td>1-15</td>
              <td>Unassigned</td>
              <td> </td>
            </tr>
          </tbody>
        </table>
        <t>Future MP-DCCP versions 1 to 15 will be assigned from this registry using the RFC Required policy (<xref target="RFC8126" sectionFormat="of" section="4.7"/>).</t>
      </section>
      <section anchor="new-multipath-option-and-registry">
        <name>New Multipath Option Type and Registry</name>
        <t>IANA has assigned value 46 in the DCCP "Option Types" registry, as described in <xref target="MP_OPT"/>.</t>
        <t>IANA has created a new "Multipath Options" registry within the DCCP registry group. The following entries in <xref target="ref-add-proto-opt-list"/> have been added to the new "Multipath Options" registry. The registry has an upper boundary of 255 in the numeric value field.</t>
	
        <table anchor="ref-add-proto-opt-list">
          <name>Multipath Options Registry</name>
          <thead>
            <tr>
              <th>Multipath Option</th>
              <th>Name</th>
              <th>Description</th>
              <th>Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>MP_OPT=0</td>
              <td>MP_CONFIRM</td>
              <td>Confirm reception/processing of an MP_OPT option</td>
              <td>
                <xref target="MP_CONFIRM"/></td>
            </tr>
            <tr>
              <td>MP_OPT=1</td>
              <td>MP_JOIN</td>
              <td>Join subflow to an existing MP-DCCP connection</td>
              <td>
                <xref target="MP_JOIN"/></td>
            </tr>
            <tr>
              <td>MP_OPT=2</td>
              <td>MP_FAST_CLOSE</td>
              <td>Close an MP-DCCP connection unconditionally</td>
              <td>
                <xref target="MP_FAST_CLOSE"/></td>
            </tr>
            <tr>
              <td>MP_OPT=3</td>
              <td>MP_KEY</td>
              <td>Exchange key material for MP_HMAC</td>
              <td>
                <xref target="MP_KEY"/></td>
            </tr>
            <tr>
              <td>MP_OPT=4</td>
              <td>MP_SEQ</td>
              <td>Multipath sequence number</td>
              <td>
                <xref target="MP_SEQ"/></td>
            </tr>
            <tr>
              <td>MP_OPT=5</td>
              <td>MP_HMAC</td>
              <td>Hash-based message authentication code for MP-DCCP</td>
              <td>
                <xref target="MP_HMAC"/></td>
            </tr>
            <tr>
              <td>MP_OPT=6</td>
              <td>MP_RTT</td>
              <td>Transmit RTT values and calculation parameters</td>
              <td>
                <xref target="MP_RTT"/></td>
            </tr>
            <tr>
              <td>MP_OPT=7</td>
              <td>MP_ADDADDR</td>
              <td>Advertise one or more additional addresses/ports</td>
              <td>
                <xref target="MP_ADDADDR"/></td>
            </tr>
            <tr>
              <td>MP_OPT=8</td>
              <td>MP_REMOVEADDR</td>
              <td>Remove one or more addresses/ports</td>
              <td>
                <xref target="MP_REMOVEADDR"/></td>
            </tr>
            <tr>
              <td>MP_OPT=9</td>
              <td>MP_PRIO</td>
              <td>Change subflow priority</td>
              <td>
                <xref target="MP_PRIO"/></td>
            </tr>
            <tr>
              <td>MP_OPT=10</td>
              <td>MP_CLOSE</td>
              <td>Close an MP-DCCP connection</td>
              <td>
                <xref target="MP_CLOSE"/></td>
            </tr>
            <tr>
              <td>MP_OPT=11</td>
              <td>MP_EXP</td>
              <td>Experimental option for private use</td>
              <td>
                <xref target="MP_EXP"/></td>
            </tr>
            <tr>
              <td>MP_OPT=12-255</td>
              <td>Unassigned</td>
              <td></td>
              <td> </td>
            </tr>
          </tbody>
        </table>
        <t>Future Multipath Options with MP_OPT&gt;11 will be assigned from this registry using the RFC Required policy (<xref target="RFC8126" sectionFormat="of" section="4.7"/>).</t>
      </section>
      <section anchor="new-dccp-reset-code">
        <name>New DCCP-Reset Code</name>
        <t>IANA has assigned a new DCCP-Reset Code, value 13, in the "Reset Codes" registry, with the description "Abrupt MP termination".  Use of this Reset Code is defined in <xref target="MP_FAST_CLOSE"/>.</t>
      </section>
      <section anchor="new-multipath-key-type-registry">
        <name>New Multipath Key Type Registry</name>
        <t>IANA has created a new "Multipath Key Type" registry for this version of the MP-DCCP protocol that contains two different suboptions to the MP_KEY option to identify the MP_KEY Key types in terms of 8-bit values as specified in <xref target="MP_KEY"/>. See the initial  entries in <xref target="ref-mp_key-sub-opt-list"/> below. Values in the range 1-254 (decimal) inclusive remain unassigned in this specified version 0 of the protocol and will be assigned via the RFC Required policy <xref target="RFC8126"/> in potential future versions of the MP-DCCP protocol.</t>
        <table anchor="ref-mp_key-sub-opt-list">
          <name>Multipath Key Type Registry with the MP_KEY Key Types for Key Data Exchange on Different Paths</name>
          <thead>
            <tr>
              <th>Type</th>
              <th>Name</th>
              <th>Meaning</th>
              <th>Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>Plain Text</td>
              <td>Plain text Key</td>
              <td>
                <xref target="MP_KEY"/></td>
            </tr>
            <tr>
              <td>1-254</td>
              <td>Unassigned</td>
              <td></td>
              <td>
               </td>
            </tr>
            <tr>
              <td>255</td>
              <td>Experimental</td>
              <td>For private use only</td>
              <td>
                <xref target="MP_KEY"/></td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>

<displayreference target="I-D.amend-iccrg-multipath-reordering" to="MULTIPATH-REORDERING"/>
<displayreference target="I-D.amend-tsvwg-dccp-udp-header-conversion" to="U-DCCP"/>
    
    <references anchor="sec-combined-references">
      <name>References</name>
      <references anchor="sec-normative-references">
        <name>Normative References</name>

        <reference anchor="DCCP-PARAMETERS" target="https://www.iana.org/assignments/dccp-parameters">
          <front>
            <title>Datagram Congestion Control Protocol (DCCP) Parameters</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>

        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4086.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4340.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6234.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>

      </references>
      <references anchor="sec-informative-references">
        <name>Informative References</name>

<!-- [I-D.amend-iccrg-multipath-reordering]
draft-amend-iccrg-multipath-reordering-03 
IESG State: Expired as of 1/7/26
-->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.amend-iccrg-multipath-reordering.xml"/>

<!-- [I-D.amend-tsvwg-dccp-udp-header-conversion]
draft-amend-tsvwg-dccp-udp-header-conversion-01
IESG State: Expired as of 1/7/26
-->
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.amend-tsvwg-dccp-udp-header-conversion.xml"/>

        <reference anchor="IETF105.Slides" target="https://datatracker.ietf.org/meeting/105/materials/slides-105-tsvwg-sessa-62-dccp-extensions-for-multipath-operation-00">
          <front>
            <title>MP-DCCP for enabling transfer of UDP/IP traffic over multiple data paths in multi-connectivity networks</title>
            <author initials="M." surname="Amend" fullname="Markus Amend">
              <organization/>
            </author>
            <date month="July" year="2019"/>
          </front>
          <refcontent>IETF 105 Proceedings</refcontent>
        </reference>

        <reference anchor="MP-DCCP.Paper" target="https://doi.org/10.1109/LCN44214.2019.8990746">
          <front>
            <title>A Framework for Multiaccess Support for Unreliable Internet Traffic using Multipath DCCP</title>
            <author initials="M." surname="Amend" fullname="Markus Amend">
              <organization/>
            </author>
            <author initials="E." surname="Bogenfeld" fullname="Eckard Bogenfeld">
              <organization/>
            </author>
            <author initials="M." surname="Cvjetkovic" fullname="Milan Cvjetkovic">
              <organization/>
            </author>
            <author initials="V." surname="Rakocevic" fullname="Veselin Rakocevic">
              <organization/>
            </author>
            <author initials="M." surname="Pieska" fullname="Marcus Pieska">
              <organization/>
            </author>
            <author initials="A." surname="Kassler" fullname="Andreas Kassler">
              <organization/>
            </author>
            <author initials="A." surname="Brunstrom" fullname="Anna Brunstrom">
              <organization/>
            </author>
            <date year="2019" month="October"/>
          </front>
          <refcontent>2019 IEEE 44th Conference on Local Computer Networks (LCN), pp. 316-323</refcontent>
          <seriesInfo name="DOI" value="10.1109/LCN44214.2019.8990746"/>
        </reference>

        <reference anchor="MP-DCCP.Site" target="https://multipath-dccp.org/">
          <front>
            <title>Multipath extension for DCCP</title>
            <author>
              <organization/>
            </author>
          </front>
        </reference>

        <reference anchor="OLIA" target="https://dl.acm.org/doi/10.1145/2413176.2413178">
          <front>
            <title>MPTCP is not pareto-optimal: performance issues and a possible solution</title>
            <author initials="R." surname="Khalili">
              <organization/>
            </author>
            <author initials="N." surname="Gast">
              <organization/>
            </author>
            <author initials="M." surname="Popovic">
              <organization/>
            </author>
            <author initials="U." surname="Upadhyay">
              <organization/>
            </author>
            <author initials="J." surname="Le Boudec">
              <organization/>
            </author>
            <date month="December" year="2012"/>
          </front>
          <refcontent>CoNEXT '12: Proceedings of the 8th international
          conference on Emerging networking experiments and
          technologies, pp. 1-12</refcontent>
          <seriesInfo name="DOI" value="10.1145/2413176.2413178"/>
        </reference>


        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2104.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3711.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5238.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5596.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5597.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6356.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6773.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6904.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6951.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7323.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8041.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8684.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9293.xml"/>

        <reference anchor="TS23.501" target="https://www.3gpp.org/ftp//Specs/archive/23_series/23.501/23501-g70.zip">
          <front>
            <title>System architecture for the 5G System; Stage 2; Release 16</title>
            <author>
              <organization>3GPP</organization>
            </author>
            <date year="2020" month="December"/>
          </front>
          <refcontent>Version 16.7.0, Release 16</refcontent>
        </reference>



      </references>
    </references>
    <section anchor="diff_mptcp">
      <name>Differences from Multipath TCP</name>
      <t>This appendix is informative.</t>
      <t>MP-DCCP is similar to Multipath TCP <xref target="RFC8684"/> in that it
extends the related basic DCCP transport protocol <xref target="RFC4340"/> with
multipath capabilities in the same way as Multipath TCP extends TCP
<xref target="RFC9293"/>.
However, because of the differences between the underlying TCP and DCCP
protocols, the transport characteristics of MPTCP and MP-DCCP are
different.</t>
      <t><xref target="table_tcp_dccp_comp"/> compares the protocol characteristics of TCP
and DCCP, which are by nature inherited by their respective multipath
extensions.  A major difference lies in the delivery of the payload, which
for TCP is an exact copy of the generated byte stream. DCCP behaves
differently and does not guarantee the delivery of any payload nor the
order of delivery.
Since this is mainly affecting the receiving endpoint of a TCP or
DCCP communication, many similarities on the sender side can be identified.
Both transport protocols share the 3-way initiation of a
communication and both employ congestion control to adapt the sending
rate to the path characteristics.</t>
      <table anchor="table_tcp_dccp_comp">
        <name>TCP and DCCP Protocol Comparison</name>
        <thead>
          <tr>
            <th>Feature</th>
            <th>TCP</th>
            <th>DCCP</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Full-Duplex</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Connection-Oriented</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Header option space</td>
            <td>40 bytes</td>
            <td>&lt; 1008 bytes or PMTU</td>
          </tr>
          <tr>
            <td>Data transfer</td>
            <td>reliable</td>
            <td>unreliable</td>
          </tr>
          <tr>
            <td>Packet-loss handling</td>
            <td>retransmission</td>
            <td>report only</td>
          </tr>
          <tr>
            <td>Ordered data delivery</td>
            <td>yes</td>
            <td>no</td>
          </tr>
          <tr>
            <td>Sequence numbers</td>
            <td>one per byte</td>
            <td>one per PDU</td>
          </tr>
          <tr>
            <td>Flow control</td>
            <td>yes</td>
            <td>no</td>
          </tr>
          <tr>
            <td>Congestion control</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>ECN support</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Selective ACK</td>
            <td>yes</td>
            <td>depends on congestion control</td>
          </tr>
          <tr>
            <td>Fix message boundaries</td>
            <td>no</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Path MTU discovery</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Fragmentation</td>
            <td>yes</td>
            <td>no</td>
          </tr>
          <tr>
            <td>SYN flood protection</td>
            <td>yes</td>
            <td>no</td>
          </tr>
          <tr>
            <td>Half-open connections</td>
            <td>yes</td>
            <td>no</td>
          </tr>
        </tbody>
      </table>
      <t>Consequently, the multipath characteristics shown in
<xref target="table_mptcp_mpdccp_comp"/> are the same, supporting volatile paths
that have varying capacities and latency, session handovers, and path
aggregation capabilities. All of these features profit by the existence of
congestion control.</t>
      <table anchor="table_mptcp_mpdccp_comp">
        <name>MPTCP and MP-DCCP Protocol Comparison</name>
        <thead>
          <tr>
            <th>Feature</th>
            <th>MPTCP</th>
            <th>MP-DCCP</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Volatile paths</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Session handover</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Path aggregation</td>
            <td>yes</td>
            <td>yes</td>
          </tr>
          <tr>
            <td>Data reordering</td>
            <td>yes</td>
            <td>optional</td>
          </tr>
          <tr>
            <td>Expandability</td>
            <td>limited by TCP header</td>
            <td>flexible</td>
          </tr>
        </tbody>
      </table>
      <t>Therefore, the sender logic is not much different between MP-DCCP and
MPTCP.</t>
      <t>The receiver side for MP-DCCP has to deal with the unreliable delivery provided by 
DCCP. The multipath sequence numbers included in MP-DCCP (see <xref target="MP_SEQ"/>) facilitates
adding optional mechanisms for data stream packet reordering 
at the receiver.  Information from the MP_RTT Multipath Option (<xref target="MP_RTT"/>), 
DCCP path sequencing, and the DCCP Timestamp Option provide further means 
for advanced reordering approaches, e.g., as proposed in <xref target="I-D.amend-iccrg-multipath-reordering"/>.
However, such mechanisms do not affect interoperability
and are not part of the MP-DCCP protocol.  Many 
applications that use unreliable transport protocols can also inherently process 
out-of-sequence data (e.g., through adaptive audio and video buffers), 
so additional reordering support might not be necessary. The addition of optional 
reordering mechanisms are likely to be needed when the 
different DCCP subflows are routed across paths with different latencies. 
In theory, applications using DCCP are aware that packet reordering could 
occur, because DCCP does not provide mechanisms to restore the original packet order.</t>
      <t>In contrast to TCP, the receiver processing for MPTCP adopted a rigid
"just wait" approach, because TCP guarantees reliable in-order delivery.</t>
</section>
 <section anchor="acknowledgments" numbered="false" >
      <name>Acknowledgments</name>
      <t><xref target="RFC8684"/> defines Multipath TCP and provides important
      inputs for this specification.</t>
      <t>The authors gratefully acknowledge significant input into this
      document from <contact fullname="Dirk von Hugo"/>, <contact
      fullname="Nathalie Romo Moreno"/>, <contact fullname="Omar Nassef"/>,
      <contact fullname="Mohamed Boucadair"/>, <contact fullname="Simone
      Ferlin"/>, <contact fullname="Olivier Bonaventure"/>, <contact
      fullname="Gorry Fairhurst"/>, and <contact fullname="Behcet
      Sarikaya"/>.</t>
    </section>
  </back>
</rfc>
