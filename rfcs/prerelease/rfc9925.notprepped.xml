<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-ietf-lamps-x509-alg-none-latest" category="std" consensus="true" submissionType="IETF" xml:lang="en" number="9925" updates="5280" tocInclude="true" sortRefs="true" symRefs="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.31.0 -->
  <front>
    <title>Unsigned X.509 Certificates</title>
    <seriesInfo name="RFC" value="9925"/>
    <author initials="D." surname="Benjamin" fullname="David Benjamin">
      <organization>Google LLC</organization>
      <address>
        <email>davidben@google.com</email>
      </address>
    </author>
    <date year="2026" month="February"/>
    <area>SEC</area>
    <workgroup>lamps</workgroup>
    <keyword>self-signed certificate</keyword>
    <abstract>
      <?line 56?>

<t>This document defines a placeholder X.509 signature algorithm that may be used
in contexts where the consumer of the certificate is not expected to verify the
signature. As part of this, it updates RFC 5280.</t>
    </abstract>
  </front>
  <middle>
    <?line 62?>

<section anchor="introduction">
      <name>Introduction</name>
      <t>An X.509 certificate <xref target="RFC5280"/> relates two entities in the PKI: information
about a subject and a proof from an issuer. Viewing the PKI as a graph with
entities as nodes, as in <xref target="RFC4158"/>, a certificate is an edge between the
subject and issuer.</t>
      <t>In some contexts, an application needs standalone subject information instead of
a certificate. In the graph model, the application needs a node, not an edge.
For example, certification path validation (<xref section="6" sectionFormat="of" target="RFC5280"/>) begins at
a trust anchor, sometimes referred to as a root certification authority (root CA). The application
trusts this trust anchor information out-of-band and does not require an
issuer's signature.</t>
      <t>X.509 does not define a structure for this scenario. Instead, X.509 trust
anchors are often represented with "self-signed" certificates, where the
subject's key signs over itself. Other formats, such as <xref target="RFC5914"/>, exist to
convey trust anchors, but self-signed certificates remain widely used.</t>
      <t>Additionally, some TLS <xref target="RFC8446"/> server deployments use self-signed
end entity certificates when they do not intend to present a CA-issued
identity, instead expecting the relying party to authenticate the certificate
out-of-band, e.g., via a known fingerprint.</t>
      <t>These self-signatures typically have no security value, aren't checked by
the receiver, and only serve as placeholders to meet syntactic requirements of
an X.509 certificate.</t>
      <t>Computing signatures as placeholders has some drawbacks:</t>
      <ul spacing="normal">
        <li>
          <t>Post-quantum signature algorithms are large, so including a self-signature
significantly increases the size of the payload.</t>
        </li>
        <li>
          <t>If the subject is an end entity, rather than a CA, computing an X.509
signature risks cross-protocol attacks with the intended use of the key.</t>
        </li>
        <li>
          <t>It is ambiguous whether such a self-signature requires the CA bit in basic
constraints or keyCertSign in key usage. If the key is intended for a
non-X.509 use, asserting those capabilities is an unnecessary risk.</t>
        </li>
        <li>
          <t>If the subject is an end entity, and the end entity's key is not a signing
key (e.g., a Key Encapsulation Mechanism (KEM) key), there is no valid signature algorithm to use with the key.</t>
        </li>
      </ul>
      <t>This document defines a profile for unsigned X.509 certificates, which may be
used when the certificate is used as a container for subject information,
without any specific issuer.</t>
    </section>
    <section anchor="requirements-language">
      <name>Requirements Language</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>",
    "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>",
    "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>",
    "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be
    interpreted as described in BCP&nbsp;14 <xref target="RFC2119"/> <xref
    target="RFC8174"/> when, and only when, they appear in all capitals, as
    shown here.
        </t>
      <?line -18?>

</section>
    <section anchor="constructing-unsigned-certificates">
      <name>Constructing Unsigned Certificates</name>
      <t>This section describes how a sender constructs an unsigned certificate.</t>
      <section anchor="signature">
        <name>Signature</name>
        <t>To construct an unsigned X.509 certificate, the sender <bcp14>MUST</bcp14> set the
Certificate's signatureAlgorithm and TBSCertificate's signature fields each to
an AlgorithmIdentifier with algorithm id-alg-unsigned, defined below:</t>
        <artwork><![CDATA[
  id-alg-unsigned OBJECT IDENTIFIER ::= {1 3 6 1 5 5 7 6 36}
]]></artwork>
        <t>The parameters for id-alg-unsigned <bcp14>MUST</bcp14> be omitted. The Certificate's
signatureValue field <bcp14>MUST</bcp14> be a BIT STRING of length zero.</t>
      </section>
      <section anchor="issuer">
        <name>Issuer</name>
        <t>An unsigned certificate takes the place of a self-signed certificate in
scenarios where the application only requires subject information. It has no
issuer, so some requirements in the profile defined in <xref target="RFC5280"/> cannot
meaningfully be applied. However, the application may have pre-existing
requirements derived from <xref target="X.509"/> and <xref target="RFC5280"/>, so senders <bcp14>MAY</bcp14> construct
the certificate as if it were a self-signed certificate, if needed for
interoperability.</t>
        <t>In particular, the following fields describe a certificate's issuer:</t>
        <ul spacing="normal">
          <li>
            <t>issuer (<xref section="4.1.2.4" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
          <li>
            <t>issuerUniqueID (<xref section="4.1.2.8" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
        </ul>
        <t>The issuer field is not optional, and both <xref target="X.509"/> and
<xref section="4.1.2.4" sectionFormat="of" target="RFC5280"/> forbid empty issuers, so such a value may not be
interoperable with existing applications.</t>
        <t>If the subject is not empty, senders <bcp14>MAY</bcp14> set the issuer to the subject, similar
to how they would construct a self-signed certificate.
This may be useful in applications that, for example,
expect trust anchors to have a matching issuer and subject. This is, however, a
placeholder value. The unsigned certificate is not considered self-signed or
self-issued.</t>
        <t>Senders <bcp14>MAY</bcp14> alternatively use a short placeholder issuer consisting of a single
relative distinguished name that has a single attribute with a type of id-rdna-unsigned
and value of a zero-length UTF8String. id-rdna-unsigned is defined as follows:</t>
        <artwork><![CDATA[
  id-rdna-unsigned OBJECT IDENTIFIER ::= {1 3 6 1 5 5 7 25 1}
]]></artwork>
        <t>This placeholder name, in the string representation of <xref target="RFC4514"/>, is:</t>
        <artwork><![CDATA[
  1.3.6.1.5.5.7.25.1=#0C00
]]></artwork>
        <t>Senders <bcp14>MUST</bcp14> omit the issuerUniqueID field, as it is optional, not applicable,
and already forbidden by <xref section="4.1.2.8" sectionFormat="of" target="RFC5280"/>.</t>
      </section>
      <section anchor="extensions">
        <name>Extensions</name>
        <t>Some X.509 extensions also describe the certificate issuer and thus are not
meaningful for an unsigned certificate:</t>
        <ul spacing="normal">
          <li>
            <t>authority key identifier (<xref section="4.2.1.1" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
          <li>
            <t>issuer alternative name (<xref section="4.2.1.7" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
        </ul>
        <t>Senders <bcp14>SHOULD</bcp14> omit the authority key identifier and issuer alternative name
extensions. <xref section="4.2.1.1" sectionFormat="of" target="RFC5280"/> requires certificates to include
the authority key identifier, but it permits an exception for self-signed certificates
used when distributing a public key. This document updates <xref target="RFC5280"/> to also
permit omitting the authority key identifier in unsigned certificates.</t>
        <t>Some extensions reflect whether the subject is a CA or an end entity:</t>
        <ul spacing="normal">
          <li>
            <t>key usage (<xref section="4.2.1.3" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
          <li>
            <t>basic constraints (<xref section="4.2.1.9" sectionFormat="of" target="RFC5280"/>)</t>
          </li>
        </ul>
        <t>Senders <bcp14>SHOULD</bcp14> fill in these values to reflect the subject. That is:</t>
        <ul spacing="normal">
          <li>
            <t>If the subject is a CA, it <bcp14>SHOULD</bcp14> assert the keyCertSign key usage bit and
<bcp14>SHOULD</bcp14> include a basic constraints extension that sets the cA boolean to TRUE.</t>
          </li>
          <li>
            <t>If the subject is an end entity, it <bcp14>SHOULD NOT</bcp14> assert the keyCertSign key usage
bit, and it <bcp14>SHOULD</bcp14> either omit the basic constraints extension or set the cA
boolean to FALSE. Unlike a self-signed certificate, an unsigned certificate does
not issue itself, so there is no need to accommodate a self-signature in either
extension.</t>
          </li>
        </ul>
      </section>
    </section>
    <section anchor="consuming-unsigned-certificates">
      <name>Consuming Unsigned Certificates</name>
      <t>X.509 signatures of type id-alg-unsigned are always invalid:</t>
      <ul spacing="normal">
        <li>
          <t>When processing X.509 certificates without verifying signatures, receivers <bcp14>MAY</bcp14>
accept id-alg-unsigned.</t>
        </li>
        <li>
          <t>When verifying X.509 signatures, receivers <bcp14>MUST</bcp14> reject id-alg-unsigned.</t>
        </li>
      </ul>
      <t>In particular, X.509 validators <bcp14>MUST NOT</bcp14> accept id-alg-unsigned in the place of
a signature in the certification path.</t>
      <t>It is expected that most unmodified X.509 applications will already be
compliant with this guidance. X.509 applications are thus <bcp14>RECOMMENDED</bcp14> to satisfy these
requirements by ignoring this document and instead treating id-alg-unsigned as
the same as an unrecognized signature algorithm. An unmodified X.509
validator will be unable to verify the signature (Step (a.1) of
<xref section="6.1.3" sectionFormat="of" target="RFC5280"/>) and thus reject the certification path.
Conversely, in contexts where an X.509 application was ignoring the
self-signature, id-alg-unsigned will also be ignored but more efficiently.</t>
      <t>In other contexts, an application may require modifications or limit itself to
particular forms of unsigned certificates. For example, an application might
check self-signedness to classify locally configured certificates as trust
anchors or untrusted intermediates. Such an application may need to modify its
configuration model or user interface before using an unsigned certificate as a
trust anchor.</t>
    </section>
    <section anchor="security-considerations">
      <name>Security Considerations</name>
      <t>It is best practice to limit cryptographic keys to a single purpose each. If a
key is reused across contexts, applications risk cross-protocol attacks when the
two uses collide. However, in applications that use self-signed end entity
certificates, the subject's key is necessarily used in two ways: the X.509
self-signature and the end entity protocol. Unsigned certificates fix this key
reuse by removing the X.509 self-signature.</t>
      <t>If an application accepts id-alg-unsigned as part of a certification path, or
in any other context where it is necessary to verify the X.509 signature, the
signature check would be bypassed. Thus, <xref target="consuming-unsigned-certificates"/>
prohibits this and recommends that applications treat id-alg-unsigned the same
as any other previously unrecognized signature algorithm. Non-compliant
applications risk vulnerabilities analogous to those described in <xref target="JWT"/> and
<xref section="1.1" sectionFormat="of" target="I-D.ietf-jose-deprecate-none-rsa15"/>.</t>
      <t>The signature in a self-signed certificate is self-derived and thus of limited
use to convey trust. However, some applications might, for example, use it as an integrity
check to guard against accidental storage corruption. An unsigned
certificate does not provide any integrity check. Applications checking
self-signature for integrity <bcp14>SHOULD</bcp14> instead use some other mechanism, such as an
external hash that is verified out-of-band.</t>
    </section>
    <section anchor="iana-considerations">
      <name>IANA Considerations</name>
      <section anchor="module-identifier">
        <name>Module Identifier</name>
        <t>IANA has added the following entry in the "SMI Security for PKIX
Module Identifier" registry, defined by <xref target="RFC7299"/>:</t>
        <table>
          <thead>
            <tr>
              <th align="left">Decimal</th>
              <th align="left">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">122</td>
              <td align="left">id-mod-algUnsigned-2025</td>
              <td align="left">RFC 9925</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="algorithm">
        <name>Algorithm</name>
        <t>IANA has added the following entry to the
"SMI Security for PKIX Algorithms" registry <xref target="RFC7299"/>:</t>
        <table>
          <thead>
            <tr>
              <th align="left">Decimal</th>
              <th align="left">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">36</td>
              <td align="left">id-alg-unsigned</td>
              <td align="left">RFC 9925</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="relative-distinguished-name-attribute">
        <name>Relative Distinguished Name Attribute</name>
        <t>To allocate id-rdna-unsigned, this document introduces a new PKIX OID arc for
relative distinguished name attributes:</t>
        <t>IANA has added the following entry to the "SMI Security for PKIX"
registry <xref target="RFC7299"/>:</t>
        <table>
          <thead>
            <tr>
              <th align="left">Decimal</th>
              <th align="left">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">25</td>
              <td align="left">Relative Distinguished Name Attribute</td>
              <td align="left">RFC 9925</td>
            </tr>
          </tbody>
        </table>
        <t>IANA has created the "SMI Security for PKIX Relative Distinguished
Name Attribute" registry within the "Structure of Management Information (SMI)
Numbers (MIB Module Registrations)" registry group.</t>
        <t>The new registry's description is
"iso.org.dod.internet.security.mechanisms.pkix.rdna (1.3.6.1.5.5.7.25)".</t>
        <t>The new registry has three columns and is initialized with the following values:</t>
        <table>
          <thead>
            <tr>
              <th align="left">Decimal</th>
              <th align="left">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1</td>
              <td align="left">id-rdna-unsigned</td>
              <td align="left">RFC 9925</td>
            </tr>
          </tbody>
        </table>
        <t>Future updates to this table are to be made according to the Specification
Required policy as defined in <xref target="RFC8126"/>.</t>
      </section>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-jose-deprecate-none-rsa15" to="JOSE"/>
    <references anchor="sec-combined-references">
      <name>References</name>
      <references anchor="sec-normative-references">
        <name>Normative References</name>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5912.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
      </references>
      <references anchor="sec-informative-references">
        <name>Informative References</name>
        <reference anchor="JWT" target="https://www.howmanydayssinceajwtalgnonevuln.com/">
          <front>
            <title>How Many Days Has It Been Since a JWT alg:none Vulnerability?</title>
            <author initials="J." surname="Sanderson" fullname="James 'zofrex' Sanderson">
              <organization/>
            </author>
            <date/>
          </front>
        </reference>
        <reference anchor="X.509" target="https://www.itu.int/rec/t-rec-x.509/en">
          <front>
            <title>Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks</title>
            <author>
              <organization>ITU-T</organization>
            </author>
            <date year="2019" month="October"/>
          </front>
          <seriesInfo name="ITU-T Recommendation" value="X.509"/>
          <seriesInfo name="ISO/IEC" value="9594-8:2020"/>
        </reference>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-jose-deprecate-none-rsa15.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4158.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5914.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8446.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.4514.xml"/>
        <xi:include href="https://bib.ietf.org/public/rfc/bibxml/reference.RFC.7299.xml"/>
      </references>
    </references>
    <?line 322?>

<section anchor="asn1-module">
      <name>ASN.1 Module</name>
      <t>This ASN.1 module uses the conventions established by <xref target="RFC5912"/>.</t>
      <sourcecode type="asn.1"><![CDATA[
SignatureAlgorithmNone
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-algUnsigned-2025(122) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
  SIGNATURE-ALGORITHM
  FROM AlgorithmInformation-2009  -- in [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58) }
  ATTRIBUTE
  FROM PKIX-CommonTypes-2009 -- in [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkixCommon-02(57) } ;

-- Unsigned Signature Algorithm

id-alg-unsigned OBJECT IDENTIFIER ::= { iso(1)
   identified-organization(3) dod(6) internet(1) security(5)
   mechanisms(5) pkix(7) alg(6) 36 }

sa-unsigned SIGNATURE-ALGORITHM ::= {
   IDENTIFIER id-alg-unsigned
   PARAMS ARE absent
}

id-rdna-unsigned OBJECT IDENTIFIER ::= { iso(1)
   identified-organization(3) dod(6) internet(1) security(5)
   mechanisms(5) pkix(7) rdna(25) 1 }

at-unsigned ATTRIBUTE ::= {
   TYPE UTF8String (SIZE (0))
   IDENTIFIED BY id-rdna-unsigned
}

END
]]></sourcecode>
    </section>
    <section numbered="false" anchor="acknowledgements">
      <name>Acknowledgements</name>
      <t>Thanks to <contact fullname="Bob Beck"/>, <contact fullname="Nick Harper"/>, and <contact fullname="Sophie Schmieg"/> for reviewing an early
iteration of this document. Thanks to <contact fullname="Alex Gaynor"/> for providing a link to cite
for <xref target="JWT"/>. Thanks to <contact fullname="Russ Housley"/> for additional input.</t>
    </section>
  </back>
</rfc>
